<?xml version="1.0" encoding="UTF-8"?>

<!-- This file is part of the book                                 -->
<!--                                                               -->
<!--    Ordinary Differential Equations Project                    -->
<!--                                                               -->
<!-- Copyright (C) 2013-2022 Thomas W. Judson                      -->
<!-- See the file COPYING for copying conditions.                  -->

<section xml:id="secondorder01" xmlns:xi="http://www.w3.org/2001/XInclude">
    <title>Homogeneous Linear Equations</title>
    <objectives>
        <ul>

            <li><p>To understand that a second-order linear differential equation with constant coefficients is an equation of the form
                <me>a x'' + bx' + cx = 0.</me>
            and can be solved by examining the roots of the characteristic polynomial <m>ar^2 + br + c = 0</m>.</p></li>

            <li><p>To understand that  simple harmonic oscillator can be modeled by the equation
                <me>m \frac{d^2 x}{dt^2} + b \frac{dx}{dt} + k x = 0,</me>
            where <m>m \gt 0</m>, <m>k \gt 0</m>, and <m>b \geq 0</m>.</p></li>
            
        </ul>
    </objectives>
    <introduction>

        <p>A differential equation of the form
            <me>a(t) x'' + b(t) x' + c(t) x = g(t)</me>
        is called a <term>second-order linear differential equation</term>. We will first consider the case
            <me>a x'' + b x' + cx = 0,</me>
        where <m>a</m>, <m>b</m>, and <m>c</m> are constants and <m>a \neq 0</m>. An equation of this form is said to be <term>homogeneous</term> with <term>constant coefficients</term>. We already know how to solve such equations since we can rewrite them as a system of first-order linear equations. Thus, we can find the general solution of a homogeneous second-order linear differential equation with constant coefficients by computing the eigenvalues and eigenvectors of the matrix of the corresponding system.</p>

    </introduction>
        
    <subsection xml:id="secondorder01-subsection-rlc-circuit">
        <title>RLC Circuits</title>

        <p>Recall the RC circuits that we studied earlier (see <xref ref="firstlook03" />). Such circuits contained a voltage source, a capacitor, and a resistor. A battery or generator is an example of a voltage source, and a toaster or an electric stove is an example of something that might provide a resistance in a circuit. Capacitors store an electrical charge and are used in electronic flashes for cameras. We will now add an inductor such as a solenoid, a coil that generates a magnetic field. Inductor applications include transformers, power supplies, televisions, and radios. Our new circuit is called an RLC circuit (<xref ref="secondorder01-figure-rlc-circuit" />).</p>
        
        <figure xml:id="secondorder01-figure-rlc-circuit">
            <image width="80%" xml:id="secondorder01-rlc-circuit">
                <description>an electrical circuit containing a voltage source, and resistor, a capacitor, and an inductor</description>
                <latex-image>
                    <xi:include href="tikz/secondorder01-rlc-circuit.tex" parse="text"/>
                </latex-image>   
            </image>
           
            <caption>An RLC Circuit</caption>
        </figure>
        
        <p>Current, <m>I(t)</m>, is the rate at which a charge flows through this circuit and is measured in amperes or amps. We assign a direction to the current, and a current flowing in the opposite direction will be given negative values. The impressed voltage, <m>E(t)</m>, is measured in volts, the resistance <m>R</m> is measured in ohms, and the capacitance <m>C</m> is measured in farads. The charge on the capacitor <m>Q(t)</m> at time <m>t</m> is measured in coulombs. Inductance on the coil, <m>L</m>, is measured in henrys.</p>

        <p>The following laws from physics govern how our circuit behaves.
            <ul>

                <li><p><m>I = \dfrac{dQ}{dt}</m>.</p></li>

                <li><p>The voltage drop across a resistor is <m>IR</m> (Ohm's Law).</p></li>

                <li><p>The voltage drop across a capacitor is <m>Q/C</m>.</p></li>

                <li><p>The voltage drop across an inductor is <m>L (dI/dt)</m>.</p></li>

                <li><p>In a closed circuit the impressed voltage is equal to the sum of the voltage drops in the rest of the circuit (Kirchhoff's Second Law).</p></li>

            </ul>
        Applying Kirchhoff's Second Law  to our circuit, we have the differential equation
            <men xml:id="secondorder01-equation-RLC">L \frac{dI}{dt} + RI + \frac{1}{C} Q = E(t)</men>
        or
            <me>LQ'' + RQ' + \frac{1}{C} Q = E(t).</me>
        Differentiating both sides of <xref ref="secondorder01-equation-RLC" />, we have
            <me>L I'' + RI' + \frac{1}{C} I = E'(t).</me></p>

        <p>For example, we might consider an RLC circuit with <m>R = 1</m>, <m>L = 1</m>, and <m>C = 1</m>. At <m>t = 0</m> when both <m>I(0) =0</m> and <m>I'(0) = Q(0) = 0</m>, the impressed voltage on the circuit is given by <m>E(t) = \sin(t)</m>. Our equation becomes
            <me>I'' + I' + I = E'(t) = \cos t.</me>
        This is an example of a <term>second-order linear differential equation</term>.</p>

    </subsection>

    <subsection xml:id="secondorder01-subsection-second-order-linear-de">
        <title>Second-Order Linear Equations</title>

        <p>Suppose that we have a homogeneous second-order linear differential equation with constant coefficients,
            <men xml:id="secondorder01-equation-constant-coef">a x'' + b x' + cx = 0.</men>
        The goal of this section is to be able to solve all such equations. However, we did a great deal of work finding unique solutions to systems of first-order linear systems equations in <xref ref="linear"/>. Our efforts are now rewarded. Since each second-order homogeneous system with constant coefficients can be rewritten as a first-order linear system, we are guaranteed the existence and uniqueness of solutions. 
        Indeed, we can rewrite <xref ref="secondorder01-equation-constant-coef" /> as a system of first-order linear equations,
            <md>
                <mrow>x' &amp; = y</mrow>
                <mrow>y' &amp; = -\frac{c}{a} x - \frac{b}{a} y,</mrow>
            </md>
        and then find the general solution by computing the eigenvalues and eigenvectors of the matrix of the corresponding system.</p>

        <example xml:id="secondorder01-example-real-solutions">
            <p>Solutions of a linear system <m>{\mathbf x}' = A {\mathbf x}</m> often include terms of the form <m>e^{r t}</m>. It makes sense that solutions to equation <xref ref="secondorder01-equation-constant-coef" /> take the same form. Consider the equation
                <men xml:id="secondorder01-equation-guess">x'' + 3 x' - 10 x = 0.</men>
            If we assume that a solution is of the form <m>e^{rt}</m>, we can substitute this expression into the left-hand side of <xref ref="secondorder01-equation-guess" /> to obtain
                <md>
                    <mrow>\frac{d^2}{dt^2} e^{rt} + \frac{d}{dt} 3 e^{rt} - 10 e^{rt} &amp; = r^2 e^{rt} + 3 r e^{rt} - 10 e^{rt}</mrow>
                    <mrow>&amp; = (r^2 + 3r - 10) e^{rt}</mrow>
                    <mrow>&amp; = (r + 5)(r - 2) e^{rt}.</mrow>
                </md>
            Since <m>e^{rt}</m> is never zero, we find that <m>(r + 5)(r - 2) = 0</m> or <m>r = -5</m> or <m>2</m>. Thus, we have two solutions
                <me>x_1(t) = e^{-5t} \mbox{ and } x_2(t) = e^{2t}.</me>
            By the Principle of Superposition, 
                <men xml:id="secondorder01-equation-guess-soln">x(t) = c_1 x_1(t) + c_2 x_2(t) = c_1 e^{-5t} + c_2 e^{2t}</men>
            is a solution to <m>x'' + 3x' - 10 x = 0</m>.</p>

            <p>Indeed, this is the general solution of our second-order equation since we have a one-to-one correspondence between the solutions of 
                <me>x'' + 3x' - 10 x = 0</me>
            and the system
                <md>
                    <mrow>x' &amp; = y</mrow>
                    <mrow>y' &amp; = 10x - 3 y.</mrow>
                </md>
            The matrix associated with this system
                <me>A = \begin{pmatrix} 0 \amp 1 \\ 10 \amp -3 \end{pmatrix}</me>
            has characteristic polynomial <m>\lambda^2 + 3 \lambda - 10</m>. The eigenvalues of <m>A</m> are <m>\lambda_1 = -5</m> and <m>\lambda_2 = 2</m> with eigenvectors <m>\mathbf v_1 = (1, -5)</m> and <m>\mathbf v_2 = (1, 2)</m>, respectively. Consequently, the solution to our system is
                <me>\begin{pmatrix}
                x(t) \\ y(t)
                \end{pmatrix}
                =
                c_1 e^{-5t} \begin{pmatrix} 1 \\ -5 \end{pmatrix}
                +
                c_2 e^{2t} \begin{pmatrix} 1 \\ 2 \end{pmatrix},</me>
            which agrees with<nbsp /><xref ref="secondorder01-equation-guess-soln" />.</p>
        </example>

        <p>In general, suppose that 
            <me>a x'' + b x' + c x = 0,</me>
        where <m>a \neq 0</m>.  Applying the strategy in <xref ref="secondorder01-example-real-solutions" />, we can find the general solution for this equation by finding the roots of the quadratic polynomial <m>a \lambda^2 + b \lambda + c</m>,
            <me>\lambda = - \frac{-b \pm \sqrt{b^2 - 4ac}}{2a}.</me>
        If <m>b^2 - 4ac \gt 0</m>, we have real roots
            <me>\lambda_1 = \frac{-b + \sqrt{b^2 - 4ac}}{2a} \quad \text{and} \quad \lambda_2 = \frac{-b - \sqrt{b^2 - 4ac}}{2a},</me>
        and the solution to our second-order differential equation is
            <men xml:id="secondorder01-equation-real-soln">x(t) = c_1 e^{\lambda_1 t} + c_2 e^{\lambda_2 t},</men>
        where <m>c_1</m> and <m>c_2</m> are arbitrary constants.</p>

        <p>To prove that equation<nbsp /><xref ref="secondorder01-equation-real-soln" /> is indeed the general solution to the second-order equation <m>a x'' + b x' + c x = 0</m>, we can study the equivalent system of linear equations. If we let <m>y = x'</m>, the corresponding linear system is <m>\mathbf x' = A \mathbf x</m>, where
            <me>A = \begin{pmatrix} 0 \amp 1 \\ -c/a \amp -b/a \end{pmatrix}.</me>
        The characteristic polynomial of <m>A</m> is
            <me>p(\lambda) = \det(A - \lambda I) = \lambda^2 + \frac{b}{a} \lambda + \frac{c}{a}.</me>
        The roots of <m>p(\lambda)</m> are the same as the roots of <m>a\lambda^2 + b\lambda + c</m>.</p>

        <p>If <m>b^2 - 4ac \gt 0</m>, we have real roots
            <me>\lambda_1 = \frac{-b + \sqrt{b^2 - 4ac}}{2a} \quad \text{and} \quad \lambda_2 = \frac{-b - \sqrt{b^2 - 4ac}}{2a}.</me>
        We can find eigenvectors
            <md>
                <mrow>\mathbf v_1 \amp = \begin{pmatrix} 1 \\ (-b + \sqrt{b^2 - 4ac}\,)/2a \end{pmatrix} = \begin{pmatrix} 1 \\ \lambda_1 \end{pmatrix}</mrow>
                <mrow>\mathbf v_1 \amp = \begin{pmatrix} 1 \\ (-b - \sqrt{b^2 - 4ac}\,)/2a \end{pmatrix} = \begin{pmatrix} 1 \\ \lambda_2 \end{pmatrix}</mrow>
            </md> for <m>\lambda_1</m> and <m>\lambda_2</m>, respectively. Thus, the general solution to the system of differential equations <m>\mathbf x' = A \mathbf x</m> is 
            <me>\mathbf x(t) = \begin{pmatrix} x(t) \\ y(t) \end{pmatrix} = \begin{pmatrix} x(t) \\ x'(t) \end{pmatrix} = c_1 e^{\lambda_1 t} \begin{pmatrix} 1 \\ \lambda_1 \end{pmatrix} + c_2 e^{\lambda_2 t} \begin{pmatrix} 1 \\ \lambda_2 \end{pmatrix},</me>
        which agrees with<nbsp /><xref ref="secondorder01-equation-real-soln" />.</p>

        <example>
            <p>Now let us solve the initial value problem
                <md>
                    <mrow>x'' + 4 x' + 5 x &amp; = 0</mrow>
                    <mrow>x(0) &amp; = 1</mrow>
                    <mrow>x'(0) &amp; = 1.</mrow>
                </md>
            Again, we will assume that our solution has the form <m>x(t) = e^{rt}</m>. Substituting this function into our differential equation, we find that
                <me>0 = x'' + 4 x' + 5 x = r^2 e^{rt} + 4r e^{rt} + 5 e^{rt} = (r^2 + 4r + 5) e^{rt}.</me>
            As in <xref ref="secondorder01-example-real-solutions" />, <m>r^2 + 4r + 5 = 0</m>; however, the roots of this polynomial are complex,
                <me>r = \frac{-4 \pm \sqrt{-4}}{2} = - 2 \pm i.</me>
            Using Euler's formula, we can find a complex solution
                <me>x(t) = e^{(-2 + i)t} = e^{-2t} e^{it} = e^{-2t} (\cos t + i \sin t).</me>
            The real and imaginary parts of our solution are
                <md>
                    <mrow>x_1(t) \amp = e^{-2t} \cos t</mrow>
                    <mrow>x_2(t) \amp = e^{-2t} \sin t,</mrow>
                </md>
            respectively. We claim that both <m>x_1(t)</m> and <m>x_2(t)</m> are solutions to our differential equation. Indeed, since <m>x(t) = x_1(t) + i x_2(t)</m> is a solution,
                <md>
                    <mrow>0 \amp = ax'' + bx' + cx</mrow>
                    <mrow>\amp = a(x_1 + i x_2)'' + b(x_1 + i x_2)' + c(x_1 + i x_2)</mrow>
                    <mrow>\amp = (ax_1'' + bx_1' + cx_1) + i(ax_2'' + bx_2' + cx_2).</mrow>
                </md>
            Since the real part and the imaginary part of <m>x(t)</m> must both be zero, we can conclude that <m>ax_1'' + bx_1' + cx_1 = 0</m> and <m>ax_2'' + bx_2' + cx_2 = 0</m>. Therefore, the general solution to our equation is
                <me>x(t) = c_1 e^{-2t} \cos t + c_2 e^{-2t} \sin t.</me></p>

            <p>To apply our initial conditions <m>x(0) = 1</m> and <m>x'(0) = 1</m>, we first calculate
                <me>x'(t) = -2 e^{-2t} (c_1  \cos t + c_2 \sin t) + e^{-2t} (- c_1  \sin t + c_2 \cos t).</me>
            Thus,
                <md>
                    <mrow>1 \amp = x(0) = c_1</mrow>
                    <mrow>1 \amp = x'(0) = -2c_1  + c_2,</mrow>
                </md>
            and <m>c_1 =1</m> and <m>c_2= 3</m>. Hence, the solution to our initial value problem is
                <me>x(t) = e^{-2t} \cos t + 3 e^{-2t} \sin t.</me></p>
        </example>

        <p>As before, the corresponding linear sytem is <m>\mathbf x' = A \mathbf x</m>, where
            <me>A = \begin{pmatrix} 0 \amp 1 \\ -c/a \amp -b/a \end{pmatrix}.</me>
        If <m>b^2 - 4ac \lt 0</m>, the eigenvalue of <m>A</m> are <m>\lambda = \alpha + i \beta</m> and <m>\overline{\lambda} = \alpha - i \beta</m>, where
            <me>\alpha = - \frac{b}{2a} \quad \text{and} \quad \beta = \frac{\sqrt{4ac - b^2}}{2a}.</me>
        The vector <m>\mathbf v = (1, \alpha + i \beta)</m> is an eigenvector for <m>\lambda</m>. Thus, a solution to our system of differential equations is
            <md>
                <mrow>\mathbf x(t) \amp = \begin{pmatrix} x(t) \\ y(t) \end{pmatrix}</mrow>
                <mrow>\amp = \begin{pmatrix} x(t) \\ x'(t) \end{pmatrix}</mrow>
                <mrow>\amp = e^{(\alpha + i \beta)t} \begin{pmatrix} 1 \\ \alpha + i \beta \end{pmatrix}</mrow>
                <mrow>\amp = e^{\alpha t} (\cos \beta t + i \sin \beta t) \begin{pmatrix} 1 \\ \alpha + i \beta \end{pmatrix}</mrow>
                <mrow>\amp = e^{\alpha t} \begin{pmatrix} \cos \beta t  \\ \alpha \cos \beta t - \beta \sin \beta t \end{pmatrix} + i e^{\alpha t} \begin{pmatrix} \sin \beta t \\ \alpha \sin \beta t + \beta \cos \beta t \end{pmatrix}.</mrow>
            </md>
            Taking the real and imaginary parts of <m>x(t)</m>, we obtain two real solutions to the system, <m>x_1(t) = e^{\alpha t} \cos \beta t</m> and <m>x_2(t) = e^{\alpha t} \sin \beta t</m>. Therefore, the general solution to <m>ax_1'' + bx_1' + cx_1 = 0</m> is 
                <me>x(t) = c_1 e^{\alpha t} \cos \beta t + c_2 e^{\alpha t} \sin \beta t.</me></p>

        <p>Given a second-order linear differential equation with constant coefficients, <m>ax'' + bx' + cx = 0</m>, our strategy has been to solve the <term>characteristic equation</term> <m>a \lambda^2 + b \lambda + c = 0</m> to obtain two linearly independent solutions. We have covered the case where this equation has two distinct real solutions as well as when there are complex solutions, but what if there is only a single real solution <m>\lambda = -b/2a</m>?</p>

        <example xml:id="secondorder01-example-reduction-of-order">
            <p>Consider the equation

                <me>x'' + 2x' + x = 0.</me>
            If we choose <m>e^{\lambda t}</m> as our guess, we find
                <md>
                    <mrow>x'' + 2 x' + x &amp; = \lambda^2 e^{\lambda t} + 2\lambda e^{\lambda t} + e^{\lambda t}</mrow>
                    <mrow>&amp; = e^{\lambda t} (\lambda + 1)^2</mrow>
                    <mrow>&amp; = 0.</mrow>
                </md>
            Thus, <m>\lambda  = -1</m> and we have a solution <m>x_1(t) = e^{-t}</m>.</p>

            <p>In order to find a general solution to <m>x'' + 2x' + x = 0</m>, we must find a second solution that is not a multiple of <m>x_1(t) = e^{-t}</m>. Since we already know that <m>c x_1(t)</m> is a solution to our differential equation, we will try to generalize this observation by replacing <m>c</m> with a nonconstant function <m>v(t)</m> and then try to determine <m>v(t)</m> so that <m>v(t) x_1(t)</m> is a solution to <m>x'' + 2x' + x = 0</m>. Indeed, if 
                <me>x(t) = v(t) x_1(t) = v(t) e^{-t},</me>
            then
                <me>x'(t) = v(t) x_1'(t) + v'(t) x_1(t) = -v(t) e^{-t} + v'(t) e^{-t}</me>
            and
                <md>
                    <mrow>x''(t) &amp; = v''(t) x_1(t) + 2v'(t) x_1'(t) + v(t) x_1''(t)</mrow>
                    <mrow>&amp; = v''(t) e^{-t} - 2 v'(t) e^{-t} + v(t) e^{-t}.</mrow>
                </md>
            Consequently,
                <md>
                    <mrow>x'' + 2 x' + x &amp; = [v'' e^{-t} - 2 v' e^{-t} + v e^{-t}] + 2 [-v e^{-t} + v' e^{-t}]  + [v e^{-t}]</mrow>
                    <mrow>&amp; = e^{-t} v''</mrow>
                    <mrow>&amp; = 0,</mrow>
                </md>
            and <m>v'' = 0</m>. Therefore, <m>v = c_1 t + c_2</m>. Letting <m>c_1 = 1</m> and <m>c_2 = 0</m>, we can assume that <m>v(t) = t</m>, and the second solution to our equation is <m>x = t e^{-t}</m>. Hence, the general solution to  <m>x'' + 2x' + x = 0</m> is
                <me>x(t) = c_1 e^{-t} + c_2 t e^{-t}.</me>
            We leave it as an exercise to show that our solution agrees with the solution that we would obtain from solving the equivalent first-order linear system.</p>
        </example>

        <p>The technique that we have used in <xref ref="secondorder01-example-reduction-of-order" /> is called <term>reduction of order</term>. <idx>reduction of order</idx> We leave it as an exercise to show that this technique works in general. That is, given a second-order linear differential equation
            <me>a x'' + bx' + cx = 0</me>
        such that <m>b^2 - 4ac = 0</m>, then the general solution is given by
            <me>x(t) = c_1 e^{\lambda t} + c_2 t e^{\lambda t},</me>
        where <m>\lambda = -b/2a</m>.</p>

        <activity>
            <title>Solving Second-Order Homogeneous Linear Differential Equations</title>

            <introduction>
                <p>Solve each of the following initial value problems.</p>
            </introduction>
            <task>
                <statement>
                    <p><md>
                        <mrow>x'' - 5 x' -14 x &amp; = 0</mrow>
                        <mrow>x(0) &amp; = 0</mrow>
                        <mrow>x'(0) &amp; = 2.</mrow>
                    </md></p>
                </statement>
            </task>   
            <task>
                <statement>
                    <p><md>
                        <mrow>6x'' - 11 x' + 3 x &amp; = 0</mrow>
                        <mrow>x(0) &amp; = 0</mrow>
                        <mrow>x'(0) &amp; = 2.</mrow>
                    </md></p>
                </statement>
            </task>   
            <task>
                <statement>
                    <p><md>
                        <mrow>x'' - 14 x' + 53 x &amp; = 0</mrow>
                        <mrow>x(0) &amp; = 1</mrow>
                        <mrow>x'(0) &amp; = 1.</mrow>
                    </md></p>
                </statement>
            </task>   
            <task>
                <statement>
                    <p><md>
                        <mrow>4x'' - 20 x' + 41 x &amp; = 0</mrow>
                        <mrow>x(0) &amp; = 0</mrow>
                        <mrow>x'(0) &amp; = 1.</mrow>
                    </md></p>
                </statement>
            </task>   
            <task>
                <statement>
                    <p><md>
                        <mrow>x'' -1 4 x' +49 x &amp; = 0</mrow>
                        <mrow>x(0) &amp; = 1</mrow>
                        <mrow>x'(0) &amp; = 0.</mrow>
                    </md></p>
                </statement>
            </task>   
        </activity>

    </subsection>

    <subsection xml:id="secondorder01-subsection-harmonic-oscillators">
        <title>Classifying Harmonic Oscillators</title>
        <p>Recall from <xref ref="firstlook01-subsection-spring-mass"/> that we can model harmonic motion using the equation
            <me>m \frac{d^2 x}{dt^2} + b \frac{dx}{dt} + k x = 0.</me>
        In the case of a spring-mass system, <m>m</m> is the oscillating mass, <m>b</m> is the damping coefficient, and <m>k</m> is the spring constant. It is important to remember that both <m>m</m> and <m>k</m> are positive constants and <m>b \geq 0</m>.</p>

        <p>If <m>b = 0</m>, then the oscillator is <term>undamped</term><idx><h>harmonic oscillator</h><h>damped</h></idx> In this case,
            <men xml:id="secondorder01-equation-harmonic">m \frac{d^2 x}{dt^2} + k x = 0.</men>
        The characteristic equation is
            <me>m \lambda^2 + k = 0,</me>
        and we have eigenvalues <m>\lambda = \pm i \sqrt{k/m}</m>. Hence, the complex solution to our undamped oscillator is
            <me>e^{i \omega t} = \cos \omega t + i \sin \omega t,</me>
        where <m>\omega = \sqrt{k/m}</m>. Since both the real and imaginary parts of the complex solution are also solutions to <xref ref="secondorder01-equation-harmonic"/>, the general solution to the undamped harmonic oscillator is
            <me>x(t) = c_1 \cos \omega t + c_2 \sin \omega t,</me>
        giving us the position of the mass at time <m>t</m>. Now, of course, it is easy to determine the velocity of the mass at time <m>t</m> to be
            <me>v(t) = x'(t) = - c_1 \omega \sin \omega t + c_2 \omega \cos \omega t.</me></p>

        <example>
            <p>Suppose that an undamped harmonic oscillator is modeled by the initial value problem
                <md>
                    <mrow>\frac{d^2x}{dt^2} + 9 x \amp = 0</mrow>
                    <mrow>x(0) \amp = 2</mrow>
                    <mrow>x'(0) \amp = 1.</mrow>
                </md>
            We can quickly determine the solution of this initial value problem to be
                <md>
                    <mrow>x(t) \amp = 2 \cos 3t +\frac{1}{3} \sin 3t</mrow>
                    <mrow>v(t) \amp = \cos 3t - 6 \sin 3t,</mrow>
                </md>
            where <m>v(t) = x'(t)</m> is the velocity of the oscillator (<xref ref="secondorder01-figure-undamped-oscillator" />). Examining the phase plane of the undamped oscillator, we find that the period of the oscillations is given by <m>2 \pi / \omega = 2 \pi / 3 \approx 2.094</m> (<xref ref="secondorder01-figure-undamped-oscillator-phase-plane" />).</p>
        </example>

        <figure xml:id="secondorder01-figure-undamped-oscillator">
            <image width="70%" xml:id="secondorder01-undamped-oscillator">
                <description>position and velocity of an undamped harmonic oscillator plotted agains time</description>
                <sageplot>
                    t = var('t')
                    f(t) = 2*cos(3*t) + (1/3)* sin(3*t)
                    g(t) = cos(3*t) - 6*sin(3*t)
                    p = plot(f(t), (t, 0, 5), ymin = 6, ymax = 6, color='blue', thickness=2, axes_labels=['$t$','$x(t), v(t)$'], legend_label='$x(t)$')
                    p += plot(g(t), (t, 0, 5),ymin = -6, ymax = 6, color='red', thickness=2, legend_label='$v(t)$')
                    p
                </sageplot>
            </image>
            <caption>Position and velocity of an undamped harmonic oscillator</caption>
        </figure>

        <figure xml:id="secondorder01-figure-undamped-oscillator-phase-plane">
            <image width="20%" xml:id="secondorder01-undamped-oscillator-phase-plane">
                <description>the velocity of a harmonic oscillator plotted against the position forming an ellipse in the position-velocity plane</description>
                <sageplot>
                    t = var('t')
                    f(t) = 2*cos(3*t) + (1/3)* sin(3*t)
                    g(t) = cos(3*t) - 6*sin(3*t)
                    p = parametric_plot([f(t),g(t)], (t, 0, 5), xmax = 3, xmin = -3, ymin = -7, ymax = 7, color='blue', thickness=2, axes_labels=['$x(t)$','$v(t)$'])
                    p
                </sageplot>
            </image>
            <caption>The phase plane of an undamped harmonic oscillator</caption>
        </figure>

        <p>If we add damping to the oscillator, the equation becomes
            <men xml:id="secondorder01-equation-damped-oscillator">m \frac{d^2 x}{dt^2} + b \frac{dx}{dt} + k x = 0.</men>
       where <m>b \gt 0</m>. The charactersitic equation of <xref ref="secondorder01-equation-damped-oscillator" /> is
            <me>m\lambda^2 + b\lambda + k = 0</me>,
        which has roots
            <men xml:id="secondorder01-equation-characteristic-eq-roots">\lambda = \frac{-b \pm \sqrt{b^2 - 4mk}}{2m}.</men>
        There are three possible types of types of motion for the oscillator depending on the nature of the roots of <xref ref="secondorder01-equation-characteristic-eq-roots" />.
            <ul>
                <li><p>If the damping value of <m>b</m> is small when compared to <m>4mk</m>, then <m>b^2 - 4mk \lt 0</m> and the roots of <xref ref="secondorder01-equation-characteristic-eq-roots" /> will be complex. Furthermore, the real part of each root, <m>-b/ 2m</m>, is always negative. In such a situation, we say that the oscillator is <term>under-damped</term>. <idx><h>harmonic oscillator</h><h>under-damped</h></idx></p></li>

                <li><p>If the damping value of <m>b</m> is large , then <m>b^2 - 4mk \gt 0</m>, and we obtain distinct real negative roots for <xref ref="secondorder01-equation-characteristic-eq-roots" />. The oscillator is <term>over-damped</term>. <idx><h>harmonic oscillator</h><h>over-damped</h></idx></p></li>

                <li><p>Finally, we say that the oscillator is <term>critically-damped</term> <idx><h>harmonic oscillator</h><h>critically-damped</h></idx> if <m>b^2 - 4mk = 0</m>.</p></li>
            </ul></p>

        <example>
            <title>An Under-Damped Oscillator</title>
            <p>Suppose that an oscillator is modeled by the initial value problem
                <md>
                    <mrow>\frac{d^2 x}{dt^2} + 0.4 \frac{dx}{dt} + 1.04 x \amp = 0</mrow>
                    <mrow>x(0) \amp = 0</mrow>
                    <mrow>x'(0) \amp = 1.</mrow>
                </md>
            Notice that the damping <m>b = 0.4</m> is very small compared with the spring constant <m>k = 1.04</m>. The characteristic equation of the differential equation is <m>\lambda^2 + 0.4 \lambda + 1.04 = 0</m>, which has roots <m>\lambda = -0.2 \pm i</m>. Therefore, the complex solution must be
                <me>x(t) = e^{(-0.2 \pm i)t} = e^{-0.2t} ( \cos t + i \sin t),</me>
            and the general solution must be
                <me>x(t) = c_1 e^{-0.2t} \cos t + c_2 e^{-0.2t} \sin t.</me>
            Applying the initial conditions, our solution becomes
                <md>
                    <mrow>x(t) \amp =  e^{-0.2t} \sin t</mrow>
                    <mrow>v(t) \amp = x'(t) = e^{-0.2t} (\cos t - 0.2 \sin t).</mrow>
                </md>
            Notice that the period of the oscillations, <m>2 \pi / \omega = 2 \pi \approx 6.283</m>, does not change; however, the amplitude slowly decreases (<xref ref="secondorder01-figure-under-damped-oscillator" /> and <xref ref="secondorder01-figure-under-damped-oscillator-phase-plane" />).</p>

        </example>

       <figure xml:id="secondorder01-figure-under-damped-oscillator">
            <image width="70%" xml:id="secondorder01-under-damped-oscillator">
                <description>velocity and position plotted against time with oscillations becoming smaller as time increases</description>
                <sageplot>
                    t = var('t')
                    f(t) = exp(-0.2*t)*sin(t)
                    g(t) = diff(f,t)
                    p = plot(f(t), (t, 0, 15), ymin = 1.1, ymax = 1.1, color='blue', thickness=2, axes_labels=['$t$','$x(t), v(t)$'], legend_label='$x(t)$')
                    p += plot(g(t), (t, 0, 15),ymin = -1.1, ymax = 1.1, color='red', thickness=2, legend_label='$v(t)$')
                    p
                </sageplot>
            </image>
            <caption>Position and velocity of an under-damped harmonic oscillator</caption>
        </figure>

        <figure xml:id="secondorder01-figure-under-damped-oscillator-phase-plane">
            <image width="30%" xml:id="secondorder01-under-damped-oscillator-phase-plane">
                <description>the velocity of a harmonic oscillator plotted against the position spiraling towards the origin on the position-velocity plane</description>
                <sageplot>
                    t = var('t')
                    f(t) = exp(-0.2*t)*sin(t)
                    g(t) = diff(f,t)
                    p = parametric_plot([f(t),g(t)], (t, 0, 20),  xmax = 3, xmin = -3, ymin = -1.1, ymax = 1.1, aspect_ratio = 1, color='blue', thickness=2, axes_labels=['$x(t)$','$v(t)$'])
                    p
                </sageplot>
            </image>
            <caption>The phase plane of an under-damped harmonic oscillator</caption>
        </figure>

        <example>
            <title>An Over-Damped Oscillator</title>
            <p>We can expect a different type of behavior in the case of an over-damped oscillator. For example,
                <md>
                    <mrow>\frac{d^2 x}{dt^2} + 4 \frac{dx}{dt} + 3 x \amp = 0</mrow>
                    <mrow>x(0) \amp = 0</mrow>
                    <mrow>x'(0) \amp = 1.</mrow>
                </md>
            The characteristic equation of this initial value problem is
                <me>\lambda^2 + 4 \lambda + 3 = (\lambda + 3)(\lambda + 1) = 0;</me>
            hence, we have the general solution
                <me>x(t) = c_1 e^{-t} + c_2 e^{-3t}.</me>
            Applying the initial conditions, our solution is
                <md>
                    <mrow>x(t) \amp =  x(t) = \frac{1}{2}e^{-t} - \frac{1}{2} e^{-3t}</mrow>
                    <mrow>v(t) \amp = x'(t) = -\frac{1}{2}e^{-t} + \frac{3}{2} e^{-3t}.</mrow>
                </md>
            Notice that the damping is too strong for any oscillations to occur (<xref ref="secondorder01-figure-over-damped-oscillator" /> and <xref ref="secondorder01-figure-over-damped-oscillator-phase-plane" />).</p>
        </example>

       <figure xml:id="secondorder01-figure-over-damped-oscillator">
        
            <image width="70%" xml:id="secondorder01-over-damped-oscillator">
                <description>velocity and position plotted against time with the two curves approaching zero for large times</description>
                <sageplot>
                    t = var('t')
                    f(t) = exp(-t)/2 - exp(-3*t)/2
                    g(t) = diff(f,t)
                    p = plot(f(t), (t, 0, 5), ymin = 1.1, ymax = 1.1, color='blue', thickness=2, axes_labels=['$t$','$x(t), v(t)$'], legend_label='$x(t)$')
                    p += plot(g(t), (t, 0, 5),ymin = -1.1, ymax = 1.1, color='red', thickness=2, legend_label='$v(t)$')
                    p
                </sageplot>
            </image>
            <caption>Position and velocity of an over-damped harmonic oscillator</caption>
        </figure>

        <figure xml:id="secondorder01-figure-over-damped-oscillator-phase-plane">
            <image width="30%" xml:id="secondorder01-over-damped-oscillator-phase-plane">
                <description>the velocity of a harmonic oscillator plotted against the position with the solution curve approaching the origin on the position-velocity plane</description>
                <sageplot>
                    t = var('t')
                    f(t) = exp(-t)/2 - exp(-3*t)/2
                    g(t) = diff(f,t)
                    p = parametric_plot([f(t),g(t)], (t, 0, 20),  xmax = 3, xmin = -3, ymin = -1.1, ymax = 1.1, color='blue', aspect_ratio = 0.1, thickness=2, axes_labels=['$x(t)$','$v(t)$'])
                    p
                </sageplot>
            </image>
            <caption>The phase plane of an over-damped harmonic oscillator</caption>
        </figure>

        <example>
            <title>A Critically-Damped Oscillator</title>
            <p>As we increase the damping, the oscillations will cease to occur for some value of <m>b</m>. This will happen when <m>b^2 - 4mk = 0</m>. the At this point we have critical damping. Consider the system
                <md>
                    <mrow>\frac{d^2 x}{dt^2} + 4 \frac{dx}{dt} + 4 x \amp = 0</mrow>
                    <mrow>x(0) \amp = 0</mrow>
                    <mrow>x'(0) \amp = 1.</mrow>
                </md>
            The general solution to this initial value problem is
                <me>x(t) = c_1 e^{-2t} + c_2 t e^{-2t}.</me>
                The solution to the initial value problem is
                <md>
                    <mrow>x(t) \amp =  x(t) = t e^{-2t}</mrow>
                    <mrow>v(t) \amp = x'(t) = (1 - 2t)e^{-2t}.</mrow>
                </md>
                Although we see that no oscillations for this oscillator (<xref ref="secondorder01-figure-crit-damped-oscillator" /> and <xref ref="secondorder01-figure-crit-damped-oscillator-phase-plane" />), oscillations will commence as soon as we start to reduce the damping constant <m>b = 4</m>.</p>
        </example>

       <figure xml:id="secondorder01-figure-crit-damped-oscillator">
            <image width="70%" xml:id="secondorder01-crit-damped-oscillator">
                <description>velocity and position plotted against time with the two curves approaching zero for large times</description>
                <sageplot>
                    t = var('t')
                    f(t) = t*exp(-2*t)
                    g(t) = diff(f,t)
                    p = plot(f(t), (t, 0, 5), ymin = 1.1, ymax = 1.1, color='blue', thickness=2, axes_labels=['$t$','$x(t), v(t)$'], legend_label='$x(t)$')
                    p += plot(g(t), (t, 0, 5),ymin = -1.1, ymax = 1.1, color='red', thickness=2, legend_label='$v(t)$')
                    p
                </sageplot>
            </image>
            <caption>Position and velocity of a critically damped harmonic oscillator</caption>
        </figure>

        <figure xml:id="secondorder01-figure-crit-damped-oscillator-phase-plane">
            <image width="30%" xml:id="secondorder01-crit-damped-oscillator-phase-plane">
                <description>the phase plane of a critically damped harmonic oscillator with the solution curve approaching the origin</description>
                <sageplot>
                    t = var('t')
                    f(t) = t*exp(-2*t)
                    g(t) = diff(f,t)
                    p = parametric_plot([f(t),g(t)], (t, 0, 20),  xmax = 3, xmin = -3, ymin = -1.1, ymax = 1.1, color='blue', aspect_ratio = 0.1, thickness=2, axes_labels=['$x(t)$','$v(t)$'])
                    p
                </sageplot>
            </image>
            <caption>The phase plane of a critically damped harmonic oscillator</caption>
        </figure>

    </subsection>

    <subsection xml:id="secondorder01-subsection-important-lessons">
        <title>Important Lessons</title>

        <p><ul>
        
            <li><p>A second-order linear differential equation with constant coefficients is an equation of the form
                <me>a x'' + bx' + cx = 0.</me>
            We can guess the solution to this equation. Since we can rewrite this equation as a system of first-order linear differential equations, we can determine the general solution to <m>a x'' + bx' + cx = 0</m>.</p></li>

            <li><p>Suppose that 
                <me>a x'' + b x' + c x = 0,</me>
            where <m>a \neq 0</m> and <m>b^2 - 4ac \gt 0</m>. If the roots of <m>ar^2 + br + c</m> are <m>r_1</m> and <m>r_2</m>, the general solution to this differential equation is
                <me>x(t) = c_1 e^{r_1 t} + c_2 e^{r_2 t}.</me></p></li>

            <li><p>If  <m>b^2 - 4ac \lt 0</m>, the differential equation 
                <me>a x'' + b x' + c x = 0</me>
            has a general solution 
                <me>x(t) = c_1 e^{\alpha t} \cos \beta t + c_2 e^{\alpha t} \sin \beta t,</me>
            where <m>\alpha \pm i \beta</m> are the roots of <m>a r^2 + br + c = 0</m>.</p></li>

            <li><p>If <m>b^2 - 4ac = 0</m>, the differential equation
                <me>a x'' + b x' + c x = 0</me>
            has a general solution 
                <me>x(t) = c_1 e^{- bt/2a} + c_2 t e^{-bt/2a}.</me></p></li>

            <li><p>A simple harmonic oscillator can be modeled by the equation
                <me>m \frac{d^2 x}{dt^2} + b \frac{dx}{dt} + k x = 0,</me>
            where <m>m \gt 0</m>, <m>k \gt 0</m>, and <m>b \geq 0</m>. There are three possible types of motion for the oscillator depending on the sign of <m>b^2 - 4mk</m>.
            <ul>
                <li><p>If <m>b^2 - 4mk \lt 0</m>, the oscillator is under-damped.</p></li>

                <li><p>If <m>b^2 - 4mk \gt 0</m>, the oscillator is over-damped.</p></li>

                <li><p>If <m>b^2 - 4mk = 0</m>, the oscillator is critically damped.</p></li>
            </ul></p></li>
        </ul></p>
            
    </subsection>

    <reading-questions xml:id="reading-questions-secondorder01">

        <exercise xml:id="reading-questions-secondorder01-1">
            <p>What is the <term>characteristic equation</term> of <m>ax'' + bx' + cx = 0</m>?</p>
        </exercise>

         <exercise xml:id="reading-questions-secondorder01-2">
            <p>Describe the possible types of damping of a harmonic oscillator?</p>
        </exercise>

    </reading-questions>


    <exercises xml:id="secondorder01-exercises"  filenamebase="secondorder01">
        <title>Exercises</title>

        <exercisegroup cols="2" xml:id="secondorder01-exercises-find-solutions">
            <title>Finding General Solutions</title>
            <introduction><p>Find the general solution for each equation in <xref ref="secondorder01-exercises-find-solutions"/>.</p></introduction>
            <exercise>
                <statement>
                    <p><m>\dfrac{d^2 y}{dx^2} - y = 0</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>x'' - 2x' - 8x = 0</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>y'' + 5y = 0</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>\dfrac{d^2 x}{dt^2} + 6 \dfrac{dx}{dt} + 5x = 0</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>x'' - 10x' + 25x = 0</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>\dfrac{d^2 y}{dx^2} - 2\dfrac{dy}{dx} + 4y = 0</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>y'' - 8y' + 4y = 0</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>\dfrac{d^2 x}{dx^2} + 3\dfrac{dx}{dt} - 10x = 0</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>\dfrac{d^2 Q}{dt^2} - 4 \dfrac{dQ}{dt} + 9Q = 0</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>\dfrac{d^2 y}{dt^2} + 6 \dfrac{dy}{dt} + 9y = 0</m></p>
                </statement>
            </exercise>
        </exercisegroup>

        <exercisegroup xml:id="secondorder01-exercises-solve-ivps">
            <title>Solving Initial Value Problems</title>
            <introduction><p>Solve the initial value problems in <xref ref="secondorder01-exercises-solve-ivps"/>.</p></introduction>
            <exercise>
                <statement>
                    <p><m>\dfrac{d^2 y}{dx^2} - y = 0</m>, <m>y(0) = 1</m>, <m>y'(0) = 0</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>x'' - 2x' - 8x = 0</m>, <m>x(0) = 1</m>, <m>x'(0) = 2</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>y'' + 5y = 0</m>, <m>y(0) = 1</m>, <m>y'(0) = 1</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>\dfrac{d^2 x}{dt^2} + 6 \dfrac{dx}{dt} + 5x = 0</m>, <m>x(0) = 2</m>, <m>x'(0) = -1</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>x'' - 10x' + 25x = 0</m>, <m>x(0) = 1</m>, <m>x'(0) = 0</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>\dfrac{d^2 y}{dx^2} - 2\dfrac{dy}{dx} + 4y = 0</m>, <m>x(0) = -1</m>, <m>x'(0) = 1</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>y'' - 8y' + 4y = 0</m>, <m>y(0) = 1</m>, <m>y'(0) = -2</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>\dfrac{d^2 x}{dx^2} + 3\dfrac{dx}{dt} - 10x = 0</m>, <m>x(0) = 1</m>, <m>x'(0) = 2</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>\dfrac{d^2 Q}{dt^2} - 4 \dfrac{dQ}{dt} + 9Q = 0</m>, <m>Q(0) = -1</m>, <m>Q'(0) = 2</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>\dfrac{d^2 y}{dt^2} + 6 \dfrac{dy}{dt} + 9y = 0</m>, <m>y(0) = 0</m>, <m>y'(0) = 0</m></p>
                </statement>
            </exercise>
        </exercisegroup>

        <exercisegroup xml:id="secondorder01-exercises-harmonic-oscillators">
            <title>Harmonic Oscillators</title>
            <introduction><p>Consider the harmonic oscillators with mass <m>m</m>, damping coeeficient <m>b</m>, and spring constant <m>k</m> in <xref ref="secondorder01-exercises-harmonic-oscillators"/>.
                <ol>
                    <li><p>Write the second-order initial value problem corresponding for the harmonic oscillator.</p></li>

                    <li><p>Classify the oscillator as undamped, under-damped, over-damped, or critically damped.</p></li>

                    <li><p>Solve the initial value problem.</p></li>

                    <li><p>Sketch the <m>x(t)</m> and <m>v(t)</m>-graphs of the solution of the initial value problem.</p></li>

                    <li><p>Sketch the phase portrait of the initial value problem.</p></li>
                </ol></p></introduction>
            <exercise>
                <statement>
                    <p><m>m = 1</m>, <m>b = 1</m> <m>k = 1</m>, <m>x(0) = 1</m>, <m>v(0) = 0</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                     <p><m>m = 1</m>, <m>b = 2</m> <m>k = 3</m>, <m>x(0) = -3</m>, <m>v(0) = 4</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                     <p><m>m = 1</m>, <m>b = 5</m> <m>k = 3</m>, <m>x(0) = 2</m>, <m>v(0) = -3</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                     <p><m>m = 1</m>, <m>b = 0</m> <m>k = 25</m>, <m>x(0) = 2</m>, <m>v(0) = 0</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                     <p><m>m = 2</m>, <m>b = 3</m> <m>k = 5</m>, <m>x(0) = 2</m>, <m>v(0) = -1</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                     <p><m>m = 4</m>, <m>b = 4</m> <m>k = 1</m>, <m>x(0) = 2</m>, <m>v(0) = 1</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                     <p><m>m = 3</m>, <m>b = 4</m> <m>k = 1</m>, <m>x(0) = 2</m>, <m>v(0) = 1</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                     <p><m>m = 8</m>, <m>b = 4</m> <m>k = 1</m>, <m>x(0) = 2</m>, <m>v(0) = 1</m></p>
                </statement>
            </exercise>
        </exercisegroup>

        <exercisegroup xml:id="secondorder01-exercises-hanging-mass">
            <title>Oscillations of a Hanging Mass</title>
            <introduction>
                <p>In <xref ref="secondorder01-exercises-hanging-mass"/>, we will consider the motion of a mass <m>m</m> hanging at the end of a vertical spring as in <xref ref="secondorder01-figure-hanging-mass" />. The mass stretches the spring in a downward (positive) direction by length <m>L</m>. There are two forces acting on the point where the mass is attached to the spring<mdash />the force exerted by the spring and gravity. The force of gravity, the weight of the mass, acts downward with a magnitude of <m>mg</m>, where <m>g</m> is the acceleration due to gravity. On the other hand, the force of the spring acts upward and is given by <m>-kL</m>, where <m>L</m> is the length of the spring.<fn>This is commonly known as Hooke's law. See <xref ref="firstlook01-subsection-spring-mass" />.</fn> When the mass is hanging in equilibrium the force of gravity and the force of the spring balance each other out; that is,
                    <me>mg - kL = 0.</me></p>

                <figure xml:id="secondorder01-figure-hanging-mass">
                    <image width="60%" xml:id="secondorder01-hanging-mass">
                        <description>three springs hanging from a beam with masses attacheds the right two springs and the rightmost spring extended</description>
                        <latex-image>
                            <xi:include href="tikz/secondorder01-hanging-mass.tex" parse="text"/>
                        </latex-image>
                    </image>
                    <caption>A spring-mass system</caption>
                </figure>

                <p>We would like to investigate the motion of the mass if is initially displaced or acted on by an external force. Let <m>x(t)</m> be the displacement of the mass from its equilibrium position, where a downward displacement is positive. The force acting on the mass are the weight of the mass <m>mg</m> and the force exerted by the spring, which is the total elongation of the spring, or
                    <me>-k(L + x).</me>
                By Newton's second law of motion,
                    <me>mx'' = mg - k(L + x).</me>
                Furthermore, it is possible to add a damping term, <m>bx'</m>, or even an external force <m>F(t)</m> to obtain
                    <me>mx'' = mg - k(L + x) + bx' + F(t).</me>
                Since <m>mg - kL = 0</m>, we obtain the familiar equation
                    <me>mx'' + bx' + kx = F(t).</me></p>
            </introduction>

            <exercise>
                <statement>
                     <p>Suppose that a mass of <m>100</m> grams stretches a spring <m>2</m> centimeters.
                        <ol>
                            <li><p>Determine the spring constant <m>k</m>.</p></li>

                            <li><p>If the mass is displaced an additional <m>4</m> centimeters and released, write an initial value problem that will model the motion of the oscillating mass.</p></li>

                            <li><p>Solve the initial value problem.</p></li>
                        </ol></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                     <p>Suppose that a mass of <m>1</m> kilogram stretches a spring <m>5</m> centimeters.
                        <ol>
                            <li><p>Determine the spring constant <m>k</m>.</p></li>

                            <li><p>If the mass is displaced an additional <m>5</m> centimeters and released, write an initial value problem that will model the motion of the oscillating mass.</p></li>

                            <li><p>Suppose the the spring-mass system is suspended in a fluid that exerts a resistance of <m>0.25</m> kilograms when the mass has a velocity of <m>2</m> centimeters per second. Modify the intial-value problem that you wrote in (b) to take this fact into account.</p></li>

                            <li><p>Solve the initial value problem.</p></li>
                        </ol></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                     <p>Suppose that a mass weighing 4 lbs stretches a spring 3 inches.
                        <ol>
                            <li><p>If <m>g = 32 \text{ft/sec}^2</m>, determine <m>m</m>.</p></li>

                            <li><p>Determine the spring constant <m>k</m>.</p></li>

                            <li><p>If the mass is displaced an additional 6 inches and released, write an initial value problem that will model the motion of the oscillating mass.</p></li>

                            <li><p>Solve the initial value problem.</p></li>
                        </ol></p>
                </statement>
                <hint>
                    <p>Pay careful attention to units.</p>
                </hint>
            </exercise>
        </exercisegroup>

        <exercise>
            <statement>
                <p>Let <m>a x'' + b x' + cx = 0</m>, where <m>a \neq 0</m> and <m>b^2 - 4ac = 0</m>.
                    <ol>
                        <li><p>Show that <m>x_1(t) = e^{-bt/2a}</m> is a solution to <m>a x'' + b x' + cx = 0</m>.</p></li>

                        <li><p>Assume that
                            <me>y = v(t) x_1(t) = v(t) e^{-bt/2a}</me>
                        is a solution to  <m>a x'' + b x' + cx = 0</m> and show that <m>v(t) = c_1  + c_2 t</m>.  Thus, 
                            <me>x(t) = c_1  e^{-bt/2a} + c_2 t  e^{-bt/2a}</me>
                        is a general solution for <m>a x'' + b x' + cx = 0</m>.</p></li>
                        </ol></p>
            </statement>

            <hint>
                <p><ol>
                    <li><p>Observe that
                        <md>
                            <mrow>a x_1'' + b_1' + cx_1 &amp; = a \left(\frac{-b}{2a}\right)^2e^{-bt/2a} + b \left( \frac{-b}{2a} \right) e^{-bt/2a} + c e^{-bt/2a}</mrow>
                            <mrow>&amp; = e^{-bt/2a} \left( \frac{b^2}{4a} - \frac{b^2}{2a}  + c  \right)</mrow>
                            <mrow>&amp; = e^{-bt/2a} \left( \frac{-b^2 + 4ac}{4a}  \right)</mrow>
                            <mrow>&amp; = 0.</mrow>
                        </md></p></li>

                    <li><p>If <m>y = v(t) x_1(t) = v(t) e^{-bt/2a}</m> is a solution to our differential equation, then
                        <md>
                            <mrow>a y'' + b y' + cy &amp; = a (v''x_1 + 2 v'x_1' + vx_1'' ) + b(v' x_1 + v x_1') + cv x_1</mrow>
                            <mrow>&amp; = a v''x_1 + 2a v'x_1'   + bv' x_1 + v(a x_1'' +b  x_1' + c x_1)</mrow>
                            <mrow>&amp; = a v'' e^{-bt/2a} + \left[2a \left( \frac{-b}{2a} \right) e^{-bt/2a}   + b e^{-bt/2a} \right] v'</mrow>
                            <mrow>&amp; = a v'' e^{-bt/2a}</mrow>
                            <mrow>&amp; = 0.</mrow>
                        </md>
                    Since <m>a \neq 0</m>, we know that <m>v'' = 0</m>.  Hence, <m>v(t) = c_1  + c_2 t</m>.</p></li>
                </ol></p>
            </hint>
        </exercise> 
        <exercise>
            <statement>
                <p><em>Reduction of Order</em>.  Suppose that <m>x_1(t)</m> is a solution (not identically zero) to the equation
                    <me>x'' + p(t) x' + q(t) x = 0.</me>
                    <ol>
                        <li><p>Assume that <m>x(t) = v(t) x_1(t)</m> is a solution to <m>x'' + p(t) x' + q(t) x = 0</m> and derive the equation
                            <men xml:id="secondorder01-equation-exercise-reduction-of-order-1">x_1 v'' +(2x_1' + px_1)v' = 0.</men></p></li>

                        <li><p>Let <m>u = v'</m> and show that <xref ref="secondorder01-equation-exercise-reduction-of-order-1" /> is a first-order linear differential equation in <m>u</m>.</p></li>

                        <li><p>Show that <m>x_1(t) = 1/t</m> is a solution to 
                            <men xml:id="secondorder01-equation-exercise-reduction-of-order-2">2 t^2 x'' + 3t x' - x = 0 </men>
                        for <m>t \gt 0</m> and find a second linearly independent solution to <xref ref="secondorder01-equation-exercise-reduction-of-order-2" />.</p></li>
                    </ol></p>
            </statement>
            <hint>
                <p><ol>
                    <li><p><md>
                        <mrow>x'' + px' + qx &amp; = (v''x_1 + 2 v' x_1' + vx_1'') + p(v'x_1 + vx_1') + q(vx_1)</mrow>
                        <mrow>&amp; = x_1 v'' + 2v' x_1' + p x_1 v' + v (x_1'' + p x_1' + q x_1)</mrow>
                        <mrow>&amp; = x_1 v'' +(2x_1' + px_1)v' </mrow>
                        <mrow>&amp; = 0.</mrow>
                    </md></p></li>

                    <li><p>If <m>u = v'</m>, then <m>x_1 u' +(2x_1' + px_1)u= 0</m>.</p></li>

                    <li><p>If <m>x_1(t) = 1/t</m>, then
                        <me>2 t^2 x_1'' + 3t x_1' - x_1 = 2 t^2 \left(\frac{2}{t^3}\right) + 3t \left(\frac{-1}{t^2}\right) - \frac{1}{t} = 0.</me>
                    If we assume that <m>x = v/t</m> is a second solution, then
                        <me>2 t^2 x'' + 3t x' - x = 2tv'' - v' = 0.</me>
                    If we let <m>u = v'</m>, then a solution of <m>2tu' - u = 0</m> is <m>u = \sqrt{t}</m> and <m>v = \int \sqrt{t} \, dt = 2 t^{3/2} / 3</m>.  Therefore, the second solution to our equation is
                        <me>x = \frac{v}{t} = \frac{2}{3} \sqrt{t}.</me></p></li>

                </ol></p>
            </hint>
        </exercise>
    </exercises>


    <subsection number="no" xml:id="secondorder01-subsection-sage">
        <title>Solving Second Order Linear Equations with Sage</title>

        <p>Second order homogeneous linear differential equations with constant coefficeints can be solved sybolically using <em>Sage</em>. For example,
            <me>x'' + 2 x' + x = 0</me>
        can be solved using the following Sage commands.</p>

        <sage>
            <input>
            t = var('t')  
            x = function('x')(t)
            DE = diff(x,t,2) + 2*diff(x,t) + x == 0
            desolve(DE, [x,t])
            </input>
            <output>
            _K1*e^(-t) + _K2*e^(-2*t)
            </output>
        </sage>

        <p>We can even solve initial value problems such as
        	<md>
        		<mrow>x'' + 2 x' + x \amp = 0</mrow>
        		<mrow>x(0) \amp = 1</mrow>
        		<mrow>x'(0) \amp = 2</mrow>
        	</md></p>

        <sage>
            <input>
            t = var('t')
            x = function('x')(t)
            DE = diff(x,t,2) + 2*diff(x,t) + x == 0
            desolve(DE, [x,t], ics=[0, 1, 2])
            </input>
            <output>
            4*e^(-t) - 3*e^(-2*t)
            </output>
        </sage>

        <p>Of course, we can add a forcing term to our initial value problem,
        	<md>
        		<mrow>x'' + 2 x' + x \amp = t \cos 2t</mrow>
        		<mrow>x(0) \amp = 1</mrow>
        		<mrow>x'(0) \amp = 2</mrow>
        	</md></p>

        <sage>
            <input>
            t = var('t')
            x = function('x')(t)
            DE = diff(x,t,2)+3*diff(x,t)+2*x == t*cos(2*t)
            desolve(DE, [x,t], ics=[0, 1, 2])
            </input>
            <output>
            -1/100*(5*t - 12)*cos(2*t) + 1/200*(30*t - 7)*sin(2*t) + 97/25*e^(-t) - 3*e^(-2*t)
            </output>
        </sage>

    </subsection>

    <exercises xml:id="secondorder01-exercises-sage" filenamebase="secondorder01">
        <title>Exercises</title>
        <introduction><p>Solve each of the following differential equations using <em>Sage</em>.</p></introduction>

            <exercise>
                <statement>
                    <p><m>\dfrac{d^2 y}{dx^2} - y = 0</m></p>
                </statement>
            </exercise>
            <sage>
                <input>
                </input>
                <output>
                </output>
            </sage>
            <exercise>
                <statement>
                    <p><m>\dfrac{d^2 y}{dx^2} - y = 0</m>, <m>y(0) = 1</m>, <m>y'(0) = 0</m></p>
                </statement>
            </exercise>
            <sage>
                <input>
                </input>
                <output>
                </output>
            </sage>
            <exercise>
                <statement>
                    <p><m>\dfrac{d^2 y}{dx^2} - y = \cos 2t</m></p>
                </statement>
            </exercise>
            <sage>
                <input>
                </input>
                <output>
                </output>
            </sage>
            <exercise>
                <statement>
                    <p><m>\dfrac{d^2 y}{dx^2} - y = \cos 2t</m>, <m>y(0) = 1</m>, <m>y'(0) = 0</m></p>
                </statement>
            </exercise>
            <sage>
                <input>
                </input>
                <output>
                </output>
            </sage>
            <exercise>
                <statement>
                    <p><m>\dfrac{d^2 y}{dx^2} - y = \cos t</m></p>
                </statement>
            </exercise>
            <sage>
                <input>
                </input>
                <output>
                </output>
            </sage>
            <exercise>
                <statement>
                    <p><m>\dfrac{d^2 y}{dx^2} - y = \cos t</m>, <m>y(0) = 1</m>, <m>y'(0) = 0</m></p>
                </statement>
            </exercise>
            <sage>
                <input>
                </input>
                <output>
                </output>
            </sage>
            <exercise>
                <statement>
                    <p><m>x'' - 2x' - 8x = 0</m></p>
                </statement>
            </exercise>
            <sage>
                <input>
                </input>
                <output>
                </output>
            </sage>
            <exercise>
                <statement>
                    <p><m>x'' - 2x' - 8x = 0</m>, <m>x(0) = 1</m>, <m>x'(0) = 2</m></p>
                </statement>
            </exercise>
            <sage>
                <input>
                </input>
                <output>
                </output>
            </sage>
            <exercise>
                <statement>
                    <p><m>x'' - 2x' - 8x = e^{-2t}</m></p>
                </statement>
            </exercise>
            <sage>
                <input>
                </input>
                <output>
                </output>
            </sage>
            <exercise>
                <statement>
                    <p><m>x'' - 2x' - 8x = e^{-2t} + e^{4t}</m></p>
                </statement>
            </exercise>
            <sage>
                <input>
                </input>
                <output>
                </output>
            </sage>
    </exercises>


</section>

<!--</section>-->
