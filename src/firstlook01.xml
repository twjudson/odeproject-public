<?xml version="1.0" encoding="UTF-8"?>

<!-- This file is part of the book                                 -->
<!--                                                               -->
<!--    Ordinary Differential Equations Project                    -->
<!--                                                               -->
<!-- Copyright (C) 2013-2020 Thomas W. Judson                      -->
<!-- See the file COPYING for copying conditions.                  -->

<section xml:id="firstlook01" xmlns:xi="http://www.w3.org/2001/XInclude">
    <title>Modeling with Differential Equations</title>
  
    <introduction>

        <p>Calculus tells us that the derivative of a function measures how the function changes. An equation relating a function to one or more of its derivatives is called a <term>differential equation</term>. The subject of differential equations is one of the most interesting and useful areas of mathematics. We can describe many interesting natural phenomena that involve change using differential equations. In addition, the theory of the subject has broad and important implications.</p>

    </introduction>
  
    <subsection xml:id="firstlook01-subsection-exponential-growth">
        <title>Exponential Growth</title>
    
        <p>We begin our study of ordinary differential equations by modeling some real world phenomena. For a particular situation that we might wish to investigate, our first task is to write an equation (or equations) that best describes the phenomenon. Suppose that we wish to study how a population <m>P(t)</m> grows with time <m>t</m>.  We might make the assumption that a constant fraction of population is having offspring at any particular time. If we also assume that the population has a constant death rate, the change in the population <m>\Delta P</m> during a small time interval <m>\Delta t</m> will be
            <me>\Delta P \approx k_{\text{birth}} P(t) \Delta t - k_{\text{death}} P(t) \Delta t,</me>
        where <m>k_{\text{birth}}</m> is the fraction of the population having offspring during the interval and <m>k_{\text{death}}</m> is the fraction of the population that dies during the interval. Equivalently, we can write
            <me>\frac{\Delta P}{ \Delta t} \approx k P(t),</me>
        where <m>k =  k_{\text{birth}} - k_{\text{death}}</m>. Since the derivative of <m>P</m> is
            <me>\frac{dP}{dt} = \lim_{\Delta t \to 0} \frac{\Delta P}{ \Delta t},</me>
        the rate of change of the population is proportional to the size of the population, or
            <men xml:id="firstlook01-equation-exponential">\frac{dP}{dt} = kP.</men></p>

        <p>The equation
            <me>\frac{dP}{dt} = kP</me>
        is one of the simplest differential equations that we will consider. The equation tells us that the population grows in proportion to its current size. It is not too difficult to see that <m>P(t) = Ce^{kt}</m> is a solution to this equation, where <m>C</m> is an arbitrary constant. Indeed, if we differentiate <m>P(t)</m>, we obtain
            <me>\frac{d}{dt} P(t) = kCe^{kt} = kP(t).</me>
        In addition, if we know the value of <m>P(t)</m>, say when <m>t = 0</m>, we can also determine the value of <m>C</m>. For example, if the population at the time <m>t = 0</m> is <m>P(0) = P_0</m>, then
            <me>P_0 = P(0) = Ce^{k \cdot 0} = C</me>
        or <m>P(t) = P_0 e^{kt}</m>. The differential equation
            <md>
              <mrow>P'(t) &amp; = k P(t),</mrow>
              <mrow>P(0) &amp; = P_0</mrow>
            </md>
        is an example of an <term>initial value problem</term><idx>initial value problem</idx> or <term>IVP</term><idx>IVP</idx>, and we say that <m>P(0) = P_0</m> is an <term>initial condition</term><idx>initial condition</idx>. Since the solution to equation <xref ref="firstlook01-equation-exponential"/> is <m>P(t) = Ce^{kt}</m>, and we say that the population grows <term>exponentially</term><idx>exponential growth</idx>.</p>

        <p>As an example, suppose that <m>P(t)</m> is a population of a colony of bacteria at time <m>t</m>, whose initial population is 1000 at <m>t = 0</m>, where time is measured in hours.  Then
            <me>1000 = P(0) = C e^0 = C,</me>
        and our solution becomes <m>P(t) = 1000e^{kt}</m>. If the population grows at three percent per hour, then
            <me>1030 = P(1) = 1000 e^k,</me>
        after one hour.  Consequently,
            <me>k = \ln 1.03 \approx 0.0296</me>
        and the solution to our initial value problem is 
            <me>P(t) = 1000e^{0.0296 t}.</me>
            Of course, it is important to realize that this is only a model. If <m>t</m> is small, our model might be reasonably accurate. However, if we let <m>t</m> be very large, our colony of bacteria could very well exceed the mass of the earth.</p>

        <p>The growth rate of a population need not be positive. For example, Italy and Japan have experienced negative growth in recent years.<fn>See <url href="https://data.worldbank.org" />.</fn> The equation <m>dP/dt = kP</m> can also be used to model phenomena such as radioactive decay and compound interest<mdash/>topics which we will explore later.</p>

        <p>To summarize, we say that the function <m>x(t) = Ce^{kt}</m> is a <term>general solution</term><idx>general solution</idx> of the equation <m>x' = kx</m>, and <m>x(t) = x_0 e^{kt}</m> is a <term>particular solution</term><idx>particular solution</idx> to the differential equation. The general solution to our equation <m>x(t) = Ce^{kt}</m> graphs as an infinite family of curves, which we will call <term>integral curves</term><idx>integral curves</idx> or <term>solution curves</term><idx>solution curves</idx> (<xref ref="firstlook01-figure-integral-curves"/>).</p>

        <p>In general, given a differential equation <m>dx/dt =f(t, x)</m>, a solution to the differential equation is a function <m>x(t)</m> such that <m>x'(t) = f(t, x(t))</m>.  Furthermore, if <m>x(t)</m> satisfies a given initial condition <m>x(0) = x_0</m>, then <m>x(t)</m> is a solution to the in initial value problem
            <md>
              <mrow>x'(t) &amp; = f(t, x),</mrow>
              <mrow>x(0) &amp; = x_0.</mrow>
            </md></p>        
    
        <figure xml:id="firstlook01-figure-integral-curves">
            <image width="60%" xml:id="firstlook01-integral-curves">
                <description>a family of curves that approach zero going left and postive or negative infinity going right</description>
                <sageplot>
                    p = plot(exp(x), (x, -2.1, 2.1), xmax=4, ymin = -350, ymax = 350, color='blue', aspect_ratio=0.005, axes_labels=['$t$','$x(t)$'], fontsize=12)
                    for n in range(1,4):
                        f(x) = exp(n*x)
                        p += plot(f(x), (x, -2.1, 2.1), xmax=4, ymin = -350, ymax = 350, color='blue', aspect_ratio=0.005)
                        p += plot(-f(x), (x, -2.1, 2.1), xmax=4, ymin = -350, ymax = 350, color='blue', aspect_ratio=0.005)
                    p += text('$x(t) = Ce^{kt}$', (-1.5, 100), color='black', fontsize=14)
                    p
                </sageplot>
            </image>
            <caption>Integral curves</caption>
        </figure>

        <activity>
            <title>Verifying Solutions</title>

            <introduction>
                <p>Use direct substitution to verify that <m>x(t)</m> is a solution of the given differential equation.</p>
            </introduction>
            <task>
                <statement>
                    <p><m>y(t) = 4e^{-5t}</m>; <m>y' = -5y</m></p>
                </statement>
            </task>
            <task>
                <statement>
                    <p><m>x(t) = 3e^{2t}</m>; <m>x' = 2x</m></p>
                </statement>
            </task>
            <task>
                <statement>
                    <p><m>x(t) = 3e^{7t}</m>; <m>x' - 7x = 0</m>, <m>x(0) = 3</m></p>
                </statement>
            </task>
            <task>
                <statement>
                    <p><m>x(t) = Ce^{2t} - 5/2</m>; <m>x' = 2x + 5</m></p>
                </statement>
            </task>
            <task>
                <statement>
                    <p><m>x(t) = \dfrac{7}{3} e^{3t^2/2} - \dfrac{1}{3}</m>; <m>x' = 3tx + t</m>, <m>x(0) = 2</m></p>
                </statement>
            </task>    
        </activity>

    </subsection>
 
    <subsection xml:id="firstlook01-subsection-logistic-growth">
        <title>Logistic Growth</title>
        
        <p>Not all populations grow exponentially; otherwise, a bacteria culture in a petri dish would grow unbounded and soon be much larger than the size of the laboratory. To see what happens if there are limiting factors to population growth, let us consider the population of fish in a children's trout pond. The number of trout will be limited by the available resources such as food supply as well as by spawning habitat. A small population of fish might grow exponentially if the pond is large and food is abundant, but the growth rate will decline as the population increases and the availability of resources declines.  We can use the <term>logistic equation</term><idx>logistic equation</idx> to model population growth in a resource limited environment.<fn>The logistic model was first used by the Belgian mathematician and physician Pierre Fran√ßois Verhulst in 1836 to predict the populations of Belgium and France.</fn></p>
    
        <p>To see how the logistic model works, let us try to adjust our model of exponential growth to account for the limited resources of the pond. We will make the following assumptions.
            <ul>

                <li>If the population of trout is small and the pond is large with abundant resources, the rate of growth will be approximately exponential,
                    <me>\frac{dP}{dt} \approx kP.</me></li>

                <li>If <m>N</m> is the maximum population of trout that the pond can support, then any population larger than <m>N</m> will decrease.  In other words,
                    <me>\frac{dP}{dt} \lt 0</me>
                for <m>P \gt N</m>.  We say that <m>N</m> is the <term>carrying capacity</term><idx>carrying capacity</idx> for the population.</li>

            </ul>Our assumptions suggest that we might try an equation of the form
                <me>\frac{dP}{dt} = k f(P) P,</me>
            where <m>f(P)</m> is a function of <m>P</m> that is close to 1 if the population is small, but negative if the population is greater than <m>N</m>. The simplest function satisfying these conditions is
                <me>f(P) = \left( 1 - \frac{P}{N} \right).</me>
            Thus, the <term>logistic population model</term><idx>logistic population model</idx> is given by the differential equation
                <me>\frac{dP}{dt} = k \left( 1 - \frac{P}{N} \right) P.</me></p>

        <example xml:id="firstlook01-example-logistic-growth">
            <p>Suppose we have a pond that will support 1000 fish, and the initial population is 100 fish. In order to determine the number of fish in the lake at any time <m>t</m>, we must find a solution to the initial value problem
                <md>
                    <mrow>\frac{dP}{dt} &amp; = k \left( 1 - \frac{P}{1000} \right) P</mrow>
                    <mrow>P(0) &amp; = 100.</mrow>
                </md>
            It is easy to verify that <m>P(t) = 1000/(9e^{-kt} + 1)</m> is the solution to our initial value problem.<fn>We will learn how to solve initial-value problems such as the one described here in <xref ref="firstlook02"/>. For the time being, we will be satisfied with being able to verify the fact that we have a solution.</fn> Certainly <m>P(0) = 100</m>, and if we differentiate <m>P</m>, we will obtain the righthand side of the differential equation,
                <md>
                    <mrow>\frac{dP}{dt} &amp; = \frac{d}{dt} \left(\frac{1000}{9e^{-kt} + 1}\right)</mrow>
                    <mrow>&amp; = 1000 k \frac{9e^{-kt}}{(9e^{-kt} + 1)^2}</mrow>
                    <mrow>&amp; = k \frac{9e^{-kt}}{(9e^{-kt} + 1)} \cdot \frac{1000}{9e^{-kt} + 1}</mrow>
                    <mrow>&amp; = k \frac{(9e^{-kt} + 1) - 1}{(9e^{-kt} + 1)} \cdot \frac{1000}{9e^{-kt} + 1}</mrow>
                    <mrow>&amp; = k \left( 1 - \frac{1000}{1000(9e^{-kt} + 1)}\right) \frac{1000}{9e^{-kt} + 1}</mrow>
                    <mrow>&amp; = k \left( 1 - \frac{P}{1000} \right) P.</mrow>
                </md>
            In addition, if we know that the population is 200 fish after one year, then 
                <me>200 = P(1) = \frac{1000}{9e^{-k} + 1},</me>
            and we can determine that 
                <me>k = \ln\left(  \frac{9}{4}\right) \approx 0.8109.</me>
            Consequently, the solution to our intial-value problem is
                <me>P(t) = \frac{1000}{9e^{-0.8109 t} + 1}.</me>
            The graph of our solution certainly fits the situation that we are modeling (<xref ref="firstlook01-figure-logistic-growth"/>).</p>
        </example>

        <figure xml:id="firstlook01-figure-logistic-growth">

            <image width="60%" xml:id="firstlook01-logistic-growth">
                <description>a curve that first increases steeply and then begins to level off just below one thousand</description>
                <sageplot>
                    f(x) = 1000/(9*exp(-0.8109 * x) + 1)
                    p = plot(f(x), (x, 0, 16), xmax=16, ymin = -100, ymax = 1100, color='blue', thickness=2, aspect_ratio=0.01, axes_labels=['$t$','$P(t)$'], fontsize=12)
                    p
                </sageplot>
            </image>

            <caption>Logistic growth</caption>

        </figure>

        <activity>
            <title>Modeling a Population with a Threshhold</title>

            <introduction>

                <p>We can modify the logistic growth model to understand how a population with a minimum threshold grows.</p>

                <p>The black rhinoceros, once the most numerous of all rhinoceros species, is now critically endangered. The black rhino, native to eastern and southern Africa, was estimated to have a population of about <m>100{,}000</m> around 1900. Because of hunting, habitat changes, competing species, and most of all illegal poaching, the number of black rhinos today is estimated to be below <m>3000</m>. If the wild population becomes too low, the animals may not be able to find suitable mates and the black rhino will become extinct. There must be a minimum population for the species to continue.  Suppose the this minimum or threshold population for the black rhino is <m>1000</m> animals and that remaining habitant in Africa will support no more that <m>20{,}000</m> rhinos. How might we model the current population, <m>P(t)</m> of black rhinos?</p>

            </introduction>

                            
            <task>
                <statement>
                    <p>For what values of <m>P</m> is the rhino population increasing? What can be said about the value of <m>dP/dt</m> for these values of <m>P</m>?</p>
                </statement>
            </task>
            
            <task>
                <statement>
                    <p>For what values of <m>P</m> is the rhino population decreasing? What can be said about the value of <m>dP/dt</m> for these values of <m>P</m>?</p>
                </statement>
            </task>
            
            <task>
                <statement>
                    <p>For what values of <m>P</m> is the rhino population in equilibrium? What can be said about the value of <m>dP/dt</m> for these values of <m>P</m>?</p>
                </statement>
            </task>
            
            <task>
                <statement>
                    <p>Find a differential equation that models the population of rhinos at time <m>t</m>.</p>
                </statement>
                <hint>
                    <p>(a) The population is increasing if <m>dP/dt \gt 0</m> and <m>1000 \lt P \lt 20000</m>.</p>
                </hint>
            </task>

        </activity>
    
    </subsection>
 
    <subsection xml:id="firstlook01-subsection-spring-mass">
        <title>A Spring-Mass Model</title>
    
        <p>Sometimes it is necessary to consider the second derivative when modeling a phenomenon. Suppose that we have a mass lying on a flat, frictionless surface and that this mass is attached to one end of a spring with the other end of the spring attached to a wall. We will denote displacement of the spring by <m>x</m>. If <m>x \gt 0</m>, then the spring is stretched. If <m>x \lt 0</m>, the spring is compressed. If <m>x = 0</m>, then the spring is in a state of equilibrium (<xref ref="firstlook01-figure-spring-mass"/>). If we pull or push on the mass and release it, then the mass will oscillate back and forth across the table.</p>
    
        <figure xml:id="firstlook01-figure-spring-mass">
            <image width="60%" xml:id="firstlook01-spring-mass">
                <description>a mass on a table that is attached to a wall with a spring and slides back and forth</description>
                <latex-image>
                    <xi:include href="tikz/firstlook01-spring-mass.tex" parse="text"/>
                </latex-image>
            </image>
            <caption>A spring-mass system</caption>
        </figure>
    
        <p>We can construct a differential equation that models our oscillating mass. First, we must consider the restorative force on the spring. We will make the assumption that this force depends on the displacement of the spring, <m>F(x)</m>. Using Taylor's Theorem from calculus, we can expand <m>F</m> to obtain
            <md>
                <mrow>F(x) &amp; =  F(0) + F'(0) x + \frac{1}{2} F''(0) x^2 + \cdots</mrow>
                <mrow>&amp; = -k x + \frac{1}{2} F''(0) x^2 + \cdots,</mrow>
            </md>
        where <m>F'(0) = -k</m> and <m>F(0) = 0</m>.  If the displacement is not too large, then <m>x^n</m> will be small for <m>n \geq 2</m>, and we can ignore higher ordered terms. Thus, we can consider the restorative force on the spring to be proportional to displacement of the spring from its equilibrium length,
            <me>F = -kx.</me>
        This equation is known as <term>Hooke's Law</term><idx>Hooke's Law</idx>. We can test this law experimentally, and it is reasonably accurate if the displacement of the spring is not too large.</p>

        <p>By Newton's second law of motion, the force on the mass must be
            <me>F = ma = m \frac{d^2 x}{dt^2} = m x''.</me>
        Setting the two forces equal, we have a <term>second-order differential equation</term><idx>second-order differential equation</idx>,
            <me>mx'' = -kx,</me>
        which describes our oscillating mass. The spring-mass system is an example of a <term>harmonic oscillator</term><idx>harmonic oscillator</idx>. Harmonic oscillators are useful for modeling simple harmonic motion in mechanics.</p>

        <example xml:id="firstlook01-example-harmonic-oscillator">

            <p>Suppose that we have a spring-mass system where <m>m =1</m> and <m>k = 1</m>. If the initial velocity of the spring is one unit per second and the initial position is at the equilibrium point, then we have the following initial value problem,
            <md>
                <mrow>x'' + x &amp; =  0</mrow>
                <mrow>x(0) &amp; =  0</mrow>
                <mrow>x'(0) &amp; =  1.</mrow>
            </md>
            Since <m>x''(t) = - x(t)</m> for both the sine and cosine functions, we might guess that a general solution of our differential equation has the form
                <me>x(t) = A \cos t + B \sin t.</me>
            Noting that
                <me>x'(t) = -A \sin t + B \cos t,</me>
            and using our initial conditions, we can determine that <m>A = 0</m> and <m>B = 1</m> or
                <me>x(t) = \sin t.</me>
            The graph of the position of the mass as a function of time is given in <xref ref="firstlook01-figure-position-mass"/>.</p>

            <figure xml:id="firstlook01-figure-position-mass">

                <image width="70%" xml:id="firstlook01-position-mass">
                    <description>a curve that begins at the origin and oscillates between plus and minus one</description>
                    <sageplot>
                        f(x) = sin(x)
                        p = plot(f(x), (x, 0, 30), xmax=30, ymin = -1.5, ymax = 1.5, color='blue', thickness=2, aspect_ratio=4, axes_labels=['$t$','$x(t)$'], fontsize=12)
                        p
                    </sageplot>
                </image>

                <caption>A undamped spring-mass system</caption>

            </figure>

        </example>

        <p>Now let us add a damping force to our system. For example, we might add a dashpot, a mechanical device that resists motion, to our system. Think of a dashpot as that small cylinder that keeps your screen door from slamming shut. The simplest assumption would be to take the damping force of the dashpot to be proportional to the velocity of the mass, <m>x'(t)</m>. In other words, the harder you try to slam the screen door, the more resistance you will feel. Thus, we have will have an additional force,
            <me>F = -b x'</me>
        acting on our mass, where <m>b \gt 0</m>. Our new equation for the spring-mass system is
            <me>mx'' = -bx' - kx.</me>
        or
            <me>mx'' + bx' + kx = 0,</me>
        where <m>m</m>, <m>b</m>, and <m>k</m> are all positive constants. The equation
            <me>mx'' + bx' + kx = 0</me>
        models a <term>simple damped harmonic oscillator</term>.<idx><h>harmonic oscillator</h><h>damped</h></idx></p>

        <example xml:id="firstlook01-example-damped-harmonic-oscillator">

            <p>Suppose that we have a spring-mass system governed by the equation
                <me>x'' + 3x' + 2x = 0.</me>
            Here we let <m>m = 1</m>, <m>b = 3</m>, and <m>k = 2</m>, We will learn how to solve equations of the form <m>mx'' + bx' + kx = 0</m> in <xref ref="secondorder"/>, but let us assume that the solution is of the form <m>x(t) = e^{rt}</m> for now. In this case,
                <md>
                    <mrow>x'' + 3x' + 2x &amp; = r^2 e^{rt} + 3 r e^{rt} + 2 e^{rt}</mrow>
                    <mrow>&amp; = e^{rt}(r^2 + 3r +2)</mrow>
                    <mrow>&amp; = e^{rt}(r+2)(r+1)</mrow>
                    <mrow>&amp; = 0.</mrow>
                </md>
            Since <m>e^{rt}</m> is never zero, it must be the case that <m>r = -2</m> or <m>r = -1</m>, if <m>x(t) = e^{rt}</m> is to be a solution to our equation. Thus, we might guess that
                <me>x(t) = A e^{-t} + B e^{-2t}</me>
            is a general solution to our equation. If the initial velocity of our mass is one unit per second and the initial position is zero, then we have the initial value problem
                <md>
                    <mrow>x'' + 3x' + 2 x &amp; = 0</mrow>
                    <mrow>x(0) &amp; = 0</mrow>
                    <mrow>x'(0) &amp; = 1.</mrow>
                </md>
            Using the fact that <m>x'(t) = -A e^{-t} -2 B e^{-2t}</m>, our initial conditions give us the following system of linear equations,
                <md>
                    <mrow>A + B &amp; = 0</mrow>
                    <mrow>-A -2B &amp; = 1.</mrow>
                </md>
            Thus, <m>A = 1</m> and <m>B = -1</m>, and our spring-mass system is modeled by the function
                <me>x(t) =  e^{-t} - e^{-2t}.</me>
            Notice that the additional damping negates any oscillation in the system. In this case, we say that the harmonic oscillator is <term>over-damped</term><idx><h>harmonic oscillator</h><h>over-damped</h></idx> (<xref ref="firstlook01-figure-over-damped"/>).</p>

            <figure xml:id="firstlook01-figure-over-damped">

                <image width="70%" xml:id="firstlook01-over-damped">
                    <description>a curve that starts at the origin and rises steeply and then slowly decreases towards zero</description>
                    <sageplot>
                        f(x) = exp(-x) - exp(-2*x)
                        p = plot(f(x), (x, 0, 10), xmax=10, ymin = -0.1, ymax = 0.3, color='blue', thickness=2, aspect_ratio=12, axes_labels=['$t$','$x(t)$'], fontsize=12)
                        p
                    </sageplot>
                </image>

                <caption>An over-damped spring-mass system</caption>

            </figure>
        
            <p>Of course, if we have a very strong spring and only add a small amount of damping to our spring-mass system, the mass would continue to oscillate, but the oscillations would become progressively smaller. In other words, our harmonic oscillator would be <term>under-damped</term>. <idx><h>harmonic oscillator</h><h>under-damped</h></idx> For example, our spring-mass system might be described by the initial value problem
                <md>
                    <mrow>x'' + 2x' + 50 x &amp; = 0</mrow>
                    <mrow>x(0) &amp; = 0</mrow>
                    <mrow>x'(0) &amp; = 1.</mrow>
                </md>
            It is easy to verify that
                <me>x(t) = \frac{1}{7} e^{-t} \sin 7t</me>
            is a solution to the initial value problem (<xref ref="firstlook01-figure-under-damped"/>).</p>

            <figure xml:id="firstlook01-figure-under-damped">

                <image width="70%" xml:id="firstlook01-under-damped">
                    <description>a curve that starts at the origin and oscillates with the amplitude slowly decreasing</description>
                    <sageplot>
                        f(x) = exp(-x)*sin(7*x)/7
                        p = plot(f(x), (x, 0, 10), xmax=10, ymin = -0.1, ymax = 0.15, color='blue', thickness=2, aspect_ratio=16, axes_labels=['$t$','$x(t)$'], fontsize=12)
                        p
                    </sageplot>
                </image>

                <caption>An under-damped spring-mass system</caption>

            </figure>
        </example>

        <p>We will revisit harmonic oscillators and second-order differential equations more fully in <xref ref="secondorder"/>.</p>
    
    </subsection>
  
    <subsection xml:id="firstlook01-subsection-predator-prey">
        <title>A Predator-Prey System</title>
    
        <p>Some situations require more than one differential equation to model a particular phenomenon. We might use a system of differential equations to model two interacting species, say where one species preys on the other.<fn>The predator-prey model was discovered independently by Lotka (1925) and Volterra (1926).</fn> For example, we can model how the population of Canadian lynx (<em>lynx canadenis</em>) interacts with a the population of snowshoe hare (<em>lepus americanis</em>) (see <url href="https://www.youtube.com/watch?v=ZWucOrSOdCs" />).</p>

        <p>We have good historical data for the populations of the lynx and snowshoe hare from the Hudson Bay Company, the oldest company in North America. This large Canadian retail company, which owns and operates a large number of retail stores in North America and Europe, including Saks Fifth Avenue, was originally founded in 1670 as a fur trading company. The Hudson Bay Company kept accurate records on the number of lynx pelts that were bought from trappers from 1821 to 1940. The company noticed that the number of pelts varied from year to year and that the number of lynx pelts reached a peak about every ten years <xref ref="elton-1942"/>. The ten year cycle for lynx can be best understood using a system of differential equations.</p>
    
        <p>The primary prey for the Canadian lynx is the snowshoe hare. We will denote the population of hares by <m>H(t)</m> and the population of lynx by <m>L(t)</m>, where <m>t</m> is the time measured in years. We will make the following assumptions for our predator-prey model.
            <ul>
            
                <li>If no lynx are present, we will assume that the hares reproduce at a rate proportional to their population and are not affected by overcrowding. That is, the hare population will grow exponentially,
                    <me>\frac{dH}{dt} = aH.</me></li>

                <li>Since the lynx prey on the hares, we can argue that the rate at which the hares are consumed by the lynx is proportional to the rate at which the hares and lynx interact.  Thus, the equation that predicts the rate of change of the hare population becomes
                    <me>\frac{dH}{dt} = aH - bHL.</me>
                We are thinking of <m>HL</m> as the number of possible interactions between the lynx and the hare populations.</li>

                <li>If there is no food, the lynx population will decline at a rate proportional to itself,
                    <me>\frac{dL}{dt} = -cL.</me></li>

                <li>The lynx receive benefit from the hare population. The rate at which lynx are born is proportional to the number of hares that are eaten, and this is proportional to the rate at which the hares and lynx interact. Consequently, the growth rate of the lynx population can be described by
                    <me>\frac{dL}{dt} = -cL + dHL.</me></li>

            </ul>
        We now have a <term>system</term> of differential equations that describe how the two populations interact,
            <md>
                <mrow>\frac{dH}{dt}  &amp; =  aH - bHL,</mrow>
                <mrow>\frac{dL}{dt}  &amp; =  -cL + dHL.</mrow>
            </md >
        We will learn how to analyze and find solutions of systems of differential equations in subsequent chapters; however, we will give a graphical solution in <xref ref="firstlook01-figure-lynx-snowshoe-hare"/> to the system
            <md>
                <mrow>\frac{dH}{dt} &amp; = 0.4H - 0.01HL,</mrow>
                <mrow>\frac{dL}{dt} &amp; = -0.3L + 0.005HL.</mrow>
            </md>
        Our graphical solution is obtained using a numerical algorithm (see <xref ref="firstlook04"/> and <xref ref="systems03"/>). Notice that the predator population, <m>L</m>, begins to grow and reaches a peak after the prey population, <m>H</m> reaches its peak. As the prey population declines, the predator population also declines. Once the predator population is smaller, the prey population has a chance to recover, and the cycle begins again.<fn>An excellent account of the actual lynx and snowshoe hare data and model can be found in <xref ref="bauer-2001"/>.</fn></p>

        <figure xml:id="firstlook01-figure-lynx-snowshoe-hare">
            <image width="60%" xml:id="firstlook01-lynx-snowshoe-hare">
                <description>two curves  with the curve for the hares oscillating between forty-four and eighty and the curves for the lynx oscillating betwee fifty-four and thirty with the maximum amplitudes lagging behind the maximum amplitudes of the curve for the hares</description>
                <sageplot>
                    from sage.calculus.desolvers import desolve_system_rk4
                    H,L,t = var('H L t')
                    F = [0.4*H - 0.01*H*L, -0.3*L + 0.005*H*L]
                    P=desolve_system_rk4(F,[H,L],ics=[0,70,50],ivar=t,end_points=100)
                    Q=[ [i, j] for i,j,k in P]
                    R=[ [i, k] for i,j,k in P]
                    p = line(Q, color='red', axes_labels=['$t$','$H(t), L(t)$'], legend_label='$H(t)$', legend_color='red')
                    p += line(R, color='blue', legend_label='$L(t)$', legend_color='blue')
                    p
                </sageplot>
            </image>
            <caption>The predator-prey relationship between the lynx and the snowshoe hare</caption>
        </figure>
    
    </subsection>
  
    <subsection xml:id="firstlook01-subsection-modeling-hiv">
        <title>Modeling the HIV-1 Virus</title>
    
        <!-- Todo Check all of the details on this example-->
        
        <p>The interaction of the HIV-1 virus with the body's immune system can be modeled by a system of differential equations similar to a predator-prey system. After an individual is infected with the HIV-1 virus, the amount of the virus in the bloodstream rises dramatically and the person will often suffer from flu-like symptoms. However, these symptoms will disappear after a period of weeks or months as the body begins to manufacture antibodies against the virus. Tests have been developed to determine the presence of HIV-1 antibodies. If an individual has such antibodies, then they are said to be HIV-1 positive. Once infected with the HIV-1 virus, it can be years before an HIV-positive patient exhibits the full symptoms of AIDS. The body's immune system fights the HIV-1 virus with white blood cells. The CD4-positive T-helper cell, a specific type of white blood cell, is especially important since it helps other cells fight the virus. However, the HIV-1 virus use the CD4-positive T-helper cells to create more virions, destroying the CD4-positive T-helper cells in the process.</p>
        
        <p>We can develop a system of differential equations to better understand the dynamics of the HIV-1 virus <xref ref="perelson-2002"/>. Let <m>V = V(t)</m> be the population of the HIV-1 virus at time <m>t</m>. We will assume that the virus concentration is governed by the following differential equation,
            <me>\frac{dV}{dt} = P - cV.</me>
        The first term, <m>P</m> is some function of <m>t</m> that determines the rate at which new viral particles are created. The term <m>-cV</m> is the death rate for the virions. If someone discovers a drug that blocks the creation of new HIV-1 virions, then <m>P</m> would be zero and the virions would clear the body at the following rate,
            <me>\frac{dV}{dt} = - cV,</me>
        and <m>V(t) = V_0 e^{-ct}</m>, where <m>V_0</m> is the initial viral population.</p>

        <p>Now let us consider a model for the concentration  <m>T = T(t)</m> of (uninfected) CD4-positive T-helper cells,
            <me>\frac{dT}{dt} = s + pT\left(1 - \frac{T}{T_{\text{max}}}  \right) - d_T T.</me>
        The constant <m>s</m> represents the rate at which T-cells are created from sources in the body, such as the thymus. New CD4-positive T-helper cells can also be created from the proliferation of existing CD4-positive T-helper cells, and the second term in the equation represents the logistic growth of the T-cells, where <m>p</m> is the maximum proliferation rate and <m>T_{\text{max}}</m> is the T-cell population density where proliferation ceases. Finally, <m>d_T</m> is the death rate of the T cells.</p>

        <p>Like the influenza virus, the HIV-1 virus is an RNA virus. An RNA virus cannot reproduce on its own and must use the DNA from a host cell. To do this, the virus attaches itself to a CD4-positive T-helper cell and injects its RNA into the cell. This way the virus can use the T-cell's DNA to replicate itself using a process called reverse transcription, where a DNA copy of the virus's RNA is made. New virus particles are created, and the T-cell eventually bursts releasing the virions into the body. If we let <m>T^*</m> be the concentration of infected T-cells, we can model this process with the following system of equations,
            <md>
                <mrow>\frac{dT^*}{dt} &amp; =  kTV - \delta T^*</mrow>
                <mrow>\frac{dV}{dt} &amp; =  N \delta T^* - cV,</mrow>
            </md>
        where <m>\delta</m> is the rate of loss of the virus producing T-cells and <m>N</m> is the number of virions produced per infected T-cell during its lifetime. The term <m>kTV</m> tells us the rate at which the HIV-1 virus infects T-cells. This is the same idea as modeling how predators interact with prey in a predator-prey model. Thus, our complete model becomes
            <md>
                <mrow>\frac{dT}{dt} &amp; =  s + pT\left(1 - \frac{T}{T_{\text{max}}}  \right) - d_T T - kTV</mrow>
                <mrow>\frac{dT^*}{dt} &amp; =  kTV - \delta T^*</mrow>
                <mrow>\frac{dV}{dt} &amp; =  N \delta T^* - cV.</mrow>
            </md></p>

        <p>One class of drugs that HIV infected patients receive are reverse transcriptase (RT) inhibitors. RT inhibitors block the action of reverse transcription and prevent the virus from duplicating. If one could find the perfect RT inhibitor, then <m>k =0</m> and our system becomes
            <md>
                <mrow>\frac{dT}{dt} &amp; = s + pT\left(1 - \frac{T}{T_{\text{max}}}  \right) - d_T T</mrow>
                <mrow>\frac{dT^*}{dt} &amp; = - \delta T^*</mrow>
                <mrow>\frac{dV}{dt} &amp; = N \delta T^* - cV.</mrow>
            </md>
        Unfortunately, no one has discovered a perfect RT inhibitor, so we will need to modify the system to account for the effectiveness of the RT inhibitor. We can accomplish this by adding an effectiveness factor, <m>1 - \eta</m>, to the <m>kVT</m> term. Our system now becomes
            <md>
                <mrow>\frac{dT}{dt} &amp; =  s + pT\left(1 - \frac{T}{T_{\text{max}}}  \right) - d_T T - k(1 - \eta)TV</mrow>
                <mrow>\frac{dT^*}{dt} &amp; =  k(1 - \eta)TV - \delta T^*</mrow>
                <mrow>\frac{dV}{dt} &amp; =  N \delta T^* - cV.</mrow>
            </md>
        If <m>\eta = 1</m>, then the RT inhibitor is completely effective. On the other hand, if <m>\eta = 0</m>, then the RT inhibitor is completely ineffective. We now have a model for how the HIV-1 virus interacts with the immune system. Researchers can use data to estimate the parameters and see exactly what types of solutions are possible.</p>

    </subsection>
  
    <subsection xml:id="firstlook01-subsection-questions-for-thought">
        <title>Some Questions for Thought</title>
    
        <p>In this section we have provided a general notion of what a differential equation is as well as several modeling situations where differential equations are useful; however, we have left many questions unanswered. First, we need a more rigorous definition of a differential equation. What is the proper way to define a system of differential equations? Does a differential equation or a system of differential equations always have a solution? Are solutions to differential equations unique? If a unique solution to a differential equation exists, can we find it? If it is not possible to find a precise solution algebraically, can we estimate the solution numerically? If neither is possible, can we still say anything useful about the solution? Of course, other questions will come to mind as we continue our study of differential equations.</p>
    
    </subsection>
  
    <subsection number="no" xml:id="firstlook01-subsection-important-lessons">
        <title>Important Lessons</title>
    
        <p><ul>
            <li>A <term>differential equation</term> is an equation relating a function to one or more of its derivatives.</li>
            
            <li>An <term>initial value problem</term> is a differential equation
              <me>\frac{dx}{dt} = f(t,x),</me>
            where the <term>initial condition</term>, <m>x(t_0) = x_0</m>, is specified.</li>

            <li>A population that is not affected by overcrowding can be modeled by the differential equation <m>P' = kP</m> and is said to grow <term>exponentially</term>.</li>
            
            <li>A population that must compete for limited resources can be modeled by the <term>logistic equation</term>,
              <me>\frac{dP}{dt} = k \left( 1 - \frac{P}{N} \right) P, </me>
            where <m>N</m> is the carrying capacity of the population.</li>

            <li>Some phenomenon, such as the relationship between a population of predators and a population of prey, are best modeled by systems of differential equations.</li>
            
            <li><p>The three principle steps in modeling any phenomenon with differential equations are:
                <ul>
                
                    <li><p>Discovering the differential equation or equations that best describe a specified physical situation.</p></li>
                    
                    <li><p>Finding<mdash/>either exactly or approximately<mdash/>the appropriate solution of the equation or equations.</p></li>
                    
                    <li><p>Interpreting the solution in terms of the phenomenon.</p></li>
                    
                </ul></p></li>
          </ul></p>
    
    </subsection>

<!--
    <reading-questions xml:id="reading-questions-firstlook01">
        <introduction>
            <p>Textbooks are designed to be read. If you are student enrolled in a course, you should read each section before class. To help your understanding, answer the section's reading questions as preparation for class. If you communicate your answers to your instructor, it will aid your instructor when preparing for your class.</p>
        </introduction>

        <exercise xml:id="reading-questions-firstlook01-1">
          <p>Explain what a differential equation is using your own words.</p>
        </exercise>

         <exercise xml:id="reading-questions-firstlook01-2">
          <p>What does it mean to be a solution to a differential equation?</p>
        </exercise>

    </reading-questions>
-->
    <exercises xml:id="firstlook01-exercises" filenamebase="firstlook01">
        <title>Exercises</title>

        <exercisegroup cols="2" xml:id="firstlook01-exercises-verify-solutions">
            <title>Verifying Solutions</title>
            <introduction><p>Use direct substitution to verify that <m>y(t)</m> is a solution of the given differential equation in <xref ref="firstlook01-exercises-verify-solutions"/>.</p></introduction>

            <exercise xml:id="firstlook01-exercise-verify-solution-1">
                <statement>
                    <p><m>y(t) = e^{4t}</m>; <m>y' = 4y</m></p>
                </statement>
            </exercise>

            <exercise xml:id="firstlook01-exercise-verify-solution-2">
                <statement>
                    <p><m>y(t) = 3e^{-2t}</m>; <m>y' = -2y</m></p>
                </statement>
            </exercise>

            <exercise xml:id="firstlook01-exercise-verify-solution-3">
                <statement>
                    <p><m>y(t) = 3e^{5t}</m>; <m>y' - 5y = 0</m></p>
                </statement>
            </exercise>

            <exercise xml:id="firstlook01-exercise-verify-solution-4">
                <statement>
                    <p><m>y(t) = e^{3t} - 2</m>; <m>y' = 3y + 6</m></p>
                </statement>
            </exercise>

            <exercise xml:id="firstlook01-exercise-verify-solution-5">
                <statement>
                    <p><m>y(t) = -7e^{t^2} - \dfrac{1}{2}</m>; <m>y' = 2ty + t</m></p>
                </statement>
            </exercise>

            <exercise xml:id="firstlook01-exercise-verify-solution-6">
                <statement>
                    <p><m>y(t) = (t^8 - t^4)^{1/4}</m>; <m>y' = \dfrac{2y^4 + t^4}{ty^3}</m></p>
                </statement>
            </exercise>

            <exercise xml:id="firstlook01-exercise-verify-solution-7">
                <statement>
                    <p><m>y(t) = t</m>; <m>y'' - ty' + y = 0</m></p>
                </statement>
            </exercise>

            <exercise xml:id="firstlook01-exercise-verify-solution-8">
                <statement>
                    <p><m>y(t) = e^t + e^{2t}</m>; <m>y'' - 4y' + 4y = e^t</m></p>
                </statement>
            </exercise>
        </exercisegroup>
        

        <exercisegroup cols="2" xml:id="firstlook01-exercises-find-solutions">
            <title>Finding Solutions</title>
            <introduction><p>Many differential equations have solutions of the form <m>y(t) = e^{at}</m>, where <m>a</m> is some constant.  For example, <m>y(t) = e^{3t}</m> is a solution to the equation <m>y' = 3y</m>. Find all values of <m>a</m> such that <m>y(t) = e^{at}</m> is a solution to the given equation in <xref ref="firstlook01-exercises-find-solutions"/>.</p></introduction>

            <exercise xml:id="firstlook01-exercise-find-solution-1">
                <statement>
                    <p><m>y' = -2y</m></p>
                </statement>
            </exercise>

            <exercise xml:id="firstlook01-exercise-find-solution-2">
                <statement>
                    <p><m>y' + 7 y = 0</m></p>
                </statement>
            </exercise>

            <exercise xml:id="firstlook01-exercise-find-solution-3">
                <statement>
                    <p><m>y'' - 3y' + 2y = 0</m></p>
                </statement>
            </exercise>

            <exercise xml:id="firstlook01-exercise-find-solution-4">
                <statement>
                    <p><m>y'' + 4y' - 12y = 0</m></p>
                </statement>
            </exercise>

            <exercise xml:id="firstlook01-exercise-find-solution-5">
                <statement>
                    <p><m>y''' - y'' - 4y' + 4y = 0</m></p>
                </statement>
            </exercise>

            <exercise xml:id="firstlook01-exercise-find-solution-6">
                <statement>
                    <p><m>y^{(5)} - 5y''' + 4y' = 0</m></p>
                </statement>
            </exercise>
        </exercisegroup>

        <exercisegroup xml:id="firstlook01-exercises-ivps">
            <title>Initial Value Problems</title>
            <introduction><p>Use direct substitution to verify that <m>y(t)</m> is a solution of the given differential equation in <xref ref="firstlook01-exercises-ivps"/>. Then use the initial conditions to determine the constants <m>C</m> or <m>c_1</m> and <m>c_2</m>.</p></introduction>

            <exercise xml:id="firstlook01-exercise-ivp-1">
                <statement>
                    <p><m>y' = 4y</m>, <m>y(0) = 2</m>, <m>y(t) = ce^{4t}</m></p>
                </statement>
            </exercise>

            <exercise xml:id="firstlook01-exercise-ivp-2">
                <statement>
                    <p><m>y' + 7 y = 0</m>, <m>y(0) = 2</m>, <m>y(t) = C e^{-7t}</m></p>
                </statement>
            </exercise>

            <exercise xml:id="firstlook01-exercise-ivp-3">
                <statement>
                    <p><m>y'' + 4y = 0</m>, <m>y(0) = 1</m>, <m>y'(0) = 0</m>, <m>y(t) = c_1 \cos 2t + c_2 \sin 2t</m></p>
                </statement>
            </exercise>

            <exercise xml:id="firstlook01-exercise-ivp-4">
                <statement>
                    <p><m>y'' - 5y' + 4y = 0</m>, <m>y(0) = 1</m>, <m>y'(0) = 0</m>, <m>y(t) = c_1 e^t + c_2 e^{4t}</m></p>
                </statement>
            </exercise>

            <exercise xml:id="firstlook01-exercise-ivp-5">
                <statement>
                     <p><m>y'' + 4y' + 13y = 0</m>, <m>y(0) = 1</m>, <m>y'(0) = 0</m>, <m>y(t) = c_1 e^{-2t} \cos 3t + c_2 e^{-2t} \sin 3t</m></p>
                </statement>
            </exercise>

            <exercise xml:id="firstlook01-exercise-ivp-6">
                <statement>
                     <p><m>y'' - 4y' + 4y = 0</m>, <m>y(0) = 1</m>, <m>y'(0) = 0</m>, <m>y(t) = c_1 e^{2t} + c_2 te^{2t}</m></p>
                </statement>
            </exercise>
        </exercisegroup>

        <exercisegroup xml:id="firstlook01-exercises-bv">
            <title>Boundary Value Problems</title>
            <introduction><p>Use direct substitution to verify that <m>y(t)</m> is a solution of the given differential equation in <xref ref="firstlook01-exercises-bv"/>.  Then use the boundary conditions to determine the constants <m>c_1</m> and <m>c_2</m> (if possible).</p></introduction>

            <exercise xml:id="firstlook01-exercise-bv-1">
                <statement>
                    <p><m>y'' + 4y = 0</m>, <m>y(0) = 1</m>, <m>y(\pi) = 0</m>, <m>y(t) = c_1 \cos 2t + c_2 \sin 2t</m></p>
                </statement>
            </exercise>

            <exercise xml:id="firstlook01-exercise-bv-2">
                <statement>
                    <p><m>y'' - 5y' + 4y = 0</m>, <m>y(0) = 1</m>, <m>y(1) = 0</m>, <m>y(t) = c_1 e^t + c_2 e^{4t}</m></p>
                </statement>
            </exercise>

            <exercise xml:id="firstlook01-exercise-bv-3">
                <statement>
                     <p><m>y'' + 4y' + 13y = 0</m>, <m>y(0) = 1</m>, <m>y(\pi) = 0</m>, <m>y(t) = c_1 e^{-2t} \cos 3t + c_2 e^{-2t} \sin 3t</m></p>
                </statement>
            </exercise>

            <exercise xml:id="firstlook01-exercise-bv-4">
                <statement>
                     <p><m>y'' - 4y' + 4y = 0</m>, <m>y(0) = 1</m>, <m>y(1) = 0</m>, <m>y(t) = c_1 e^{2t} + c_2 te^{2t}</m></p>
                </statement>
            </exercise>
        </exercisegroup>

        <exercise xml:id="firstlook01-exercise-yprime-yx2-y">
            <statement>
                <p>Consider the differential equation <m>y' = y(2 - y)</m>.<ol>

                    <li>Verify that <m>y(t) = 2/(1 + Ce^{-2t})</m> is a solution to this equation.</li>

                    <li>Sketch solution curves for  <m>C = 1, 2, \ldots, 5</m>.</li>

                    <li>Verify that <m>y = 0</m> is a solution to the differential equation in part (a).  Can you find a value for <m>C</m> such that
                        <me>y(t) = \frac{2}{1 + Ce^{-2t}} = 0?</me>
                    </li>

                </ol></p>
            </statement>
        </exercise>

        <exercise xml:id="firstlook01-exercise-y-double-prime-plus-9y">
            <statement>
                <p>Consider the differential equation <m>y'' + 9y = 0</m>.<ol>
                        <li><p>Verify that <m>y(t) = c_1 \cos 3t + c_2 \sin 3t</m> is a solution to this equation.</p></li>
                        <li>Sketch solution curves for  <m>c_1 = 1</m> and <m>c_2 = 1, 2, \ldots, 5</m>.</li>
                    </ol></p>
            </statement>
        </exercise>
        
        <exercise xml:id="firstlook01-exercise-rabbit-population">
            <statement>
                <p>The growth of a population of rabbits with unlimited resources and space can be modeled by the exponential growth equation, <m>dP/dt = kP</m>.<ol>
                    <li>Write a differential equation to model a population of rabbits with unlimited resources, where hunting is allowed at a constant rate <m>\alpha</m>.</li>
                    <li>Write a differential equation to model a population of rabbits with unlimited resources, where hunting is allowed at a rate proportional to the population of rabbits.</li>
                     <li>Write a differential equation to model a population of rabbits with limited resources, where hunting is allowed at a constant rate <m>\alpha</m>.</li>
                    <li>Write a differential equation to model a population of rabbits with limited resources, where hunting is allowed at a rate proportional to the population of rabbits.</li></ol></p>
            </statement>
        </exercise>
        
        <exercise xml:id="firstlook01-exercise-first-order-linear">
            <statement>
                <p>Given the equation <m>x' + p x = q(t)</m>, where <m>p</m> is a constant and <m>q(t)</m> is a continuous function defined on an interval <m>I</m>, show that
                    <me>x(t) = Ce^{-at} + e^{-at} \int_{t_0}^t e^{as}b(s) \, ds</me>
                is a solution of this equation, where <m>c</m> is any constant and <m>t_0 \in I</m>.</p>
            </statement>
            <hint>
                 <p>Rewriting the differential equation as <m>x' + p x - q(t) = 0</m> and using the fact that
                    <me>x'(t) = -a Ce^{-at} - a e^{-at} \int_{t_0}^t e^{as}b(s) \, ds + b(t),</me>
                we see that
                    <md>
                        <mrow>x'(t) + a x(t) - b(t) &amp; = -a Ce^{-at} - a e^{-at} \int_{t_0}^t e^{as}b(s) \, ds + b(t)</mrow>
                        <mrow>&amp; + \; aCe^{-at} + ae^{-at} \int_{t_0}^t e^{as}b(s) \, ds - b(t)</mrow>
                        <mrow>&amp; = 0.</mrow>
                    </md></p>
            </hint>
        </exercise>
      
        <exercise xml:id="firstlook01-exercise-radio-carbon-dating">
            <title>Radiocarbon Dating</title>
            <statement>
                <p>Carbon 14 is a radioactive isotope of carbon, the most common isotope of carbon being carbon 12. Carbon 14 is created when cosmic ray bombardment changes nitrogen 14 to carbon 14 in the upper atmosphere. The resulting carbon 14 combines with atmospheric oxygen to form radioactive carbon dioxide, which is incorporated into plants by photosynthesis. Animals acquire carbon 14 by eating plants. When an animal or plant dies, it ceases to take on carbon 14, and the amount of isotope in the organism begins to decay into the more common carbon 12. Carbon 14 has a very long half-life, about 5730 years. That is, given a sample of carbon 14, it will take 5730 years for half of the sample to decay to carbon 12. The long half-life is what makes carbon 14 dating very useful in dating objects from antiquity.
                    <ol>
                    
                        <li>Consider a sample of material that contains <m>A(t)</m> atoms of carbon 14 at time <m>t</m>. During each unit of time a constant fraction of the radioactive atoms will spontaneously decay into another element or a different isotope of the same element. Thus, the sample behaves like a population with a constant death rate and a zero birth rate.  Make use of the model of exponential growth to construct a differential equation that models radioactive decay for carbon 14.</li>
                        
                        <li>Solve the equation that you proposed in (a) to find an explicit formula for <m>A(t)</m>.</li>

                        <li>The Chauvet-Pont-d'Arc Cave in the Ard√®che department of southern France contains some of the best preserved cave paintings in the world. Carbon samples from torch marks and from the paintings themselves, as well as from animal bones and charcoal found on the cave floor, have been used to estimate the age of the cave paintings. If a particular sample taken from the Cauvet Cave contains 2% of the expected cabon 14, what is the approximate age of the sample?</li>
                        
                    </ol></p>
            </statement>
        </exercise>
 
        <exercise xml:id="firstlook01-exercise-predator-prey">
            <statement>
                <p>Consider the following predator-prey systems of differential equations
                    <md>
                        <mrow>\frac{dx}{dt} \amp =  -\frac{x}{2} + \frac{xy}{2 + y},</mrow>
                        <mrow>\frac{dy}{dt} \amp=  y(1 - y) - \frac{xy}{2 + y}.</mrow>
                    </md>
                    <ol>

                        <li>Which equation models the prey population and which equation models the predator population?</li>

                        <li>How does the prey population grow if there are no predators present?</li>

                        <li>What happens if there are a lot of prey present?</li>

                    </ol></p>
            </statement>
            <hint>
                <p>Think about the limit of the interaction term as the number of prey becomes very large.</p>
            </hint>
        </exercise>
    
    </exercises>

    <subsection xml:id="firstlook01-subsection-sage">
        <title>An Introduction to <em>Sage</em></title>
    
         <p>Technology can prove very useful when studying differential equations. Software packages such Maple, Mathematica, and Matlab each have their advantages and disadvantages. We will use <em>Sage</em>, a readily available open source computer algebra system, as our choice of software. <em>Sage</em> can be run on an individual computer or over the Internet on a server. You can even access <em>Sage</em> from your smart phone. For our purposes, <em>Sage</em> cells are embedded into the textbook, so there is nothing to install on your computer. Simply, evaluate the cell. You can even change the preloaded commands in the cell if you wish. For example, let us evaluate the derivative of <m>f(x) = x^2 \cos x</m>.</p>
        
        <sage>
            <input>
            x = var('x') #declare x as a variable
            y = x^2*cos(x)  #set y equal to x^2*cos(x)
            solution = diff(y, x) #differentiate y with respect to x
            solution.show() #display the solutions in a nice format
            </input>
            <output>
            -x^2*sin(x) + 2*x*cos(x)
            </output>
        </sage>

        <p>Note that anything following a pound sign <c>#</c> is a comment.</p>

        <p>We can use <em>Sage</em> to plot functions. For example, we can plot the function <m>f(x) = x^2 \cos x</m> as well as its derivative on the same graph.</p>

        <sage>
            <input>
            x = var('x')
            y = x^2*cos(x)
            yprime = diff(y, x)
            p = plot(y, (x, -2, 2), color ='blue', legend_label='$f$', legend_color='blue')
            p += plot(yprime, (x, -2, 2), color='red', legend_label='$df/dx$', legend_color='red')
            p
            </input>
        </sage>
        
        <p>We can use <em>Sage</em> to solve differential equations. Suppose that we wish to solve the initial value problem
            <md>
                <mrow>\frac{dP}{dt} &amp; = kP</mrow>
                <mrow>P(0) &amp; = 1000.</mrow>
            </md>
        We can use the following commands.</p>

        <sage>
            <input>
            k,t = var('k, t') #declare variables k and t
            P = function('P')(t) #declare P to be a function of t
            de = diff(P, t) == k*P  #differential equation
            #solve specifying initial conditions
            #and independent variable solution
            solution = desolve(de, P, ivar=t, ics=[0, 1000]) 
            solution.show()
            </input>
            <output>
            1000*e^(k*t)
            </output>
        </sage>
        
        <p>We will provide abundant examples of how to use <em>Sage</em> to solve and analyze differential equations throughout the book, and we encourage the reader to experiment by altering the <em>Sage</em> commands inside the individual <em>Sage</em> cells. If you make a mistake, you can simply reload the webpage and start again.</p>

        <p>The reader will find plenty of resources to learn how to use <em>Sage</em>. A good place to start is <url href="http://www.sagemath.org/help.html" />, <xref ref="bard-2015" /> or the UTMOST Sage Cell Repository (<url href="http://utmost-sage-cell.org" />), which contains several hundred Sage cells that can be excuted right from the reposiotry website. Although we will be using <em>Sage</em> as the technology of choice, much of this book can be read independently of <em>Sage</em>. Finally, we would like to emphasize once again that the reader who chooses not to use some sort of technology will be at a disadvantage.</p>


        <exercises xml:id="firstlook01-sage-exercises" filenamebase="firstlook01">
            <title><em>Sage</em> Exercises</title>

            <exercise xml:id="firstlook01-sage-exercise-evaluate">
                <statement>
                    <p>In the <em>Sage</em> cell below enter <c>2 + 2</c> and then evaluate the cell. Your answer should be <c>4</c> of course.  Next try entering <c>2^1000</c>. You should see a very large number.</p>

                    <sage>
                        <input>
                        </input>
                        <output>
                        </output>
                    </sage>

                </statement>
            </exercise>

        </exercises>

    </subsection>


</section>

<!--</section>-->
