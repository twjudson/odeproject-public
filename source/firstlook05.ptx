<?xml version="1.0" encoding="UTF-8"?>

<!-- This file is part of the book                                 -->
<!--                                                               -->
<!--    Ordinary Differential Equations Project                    -->
<!--                                                               -->
<!-- Copyright (C) 2013-2025 Thomas W. Judson                      -->
<!-- See the file COPYING for copying conditions.                  -->

 <section xml:id="firstlook05" xmlns:xi="http://www.w3.org/2001/XInclude">
     <title>First-Order Linear Equations</title>
    <objectives>
        <ul>
            
            <li><p>To understand that any <term>first-order linear differential equation</term>
                <me>y' + p(x) y = g(x)</me>
            can be solved by multiplying each side of the equation by an <term>integrating factor</term>.</p></li>

            <li><p>To understand the existence and uniqueness of solutions to first-order initial value problems.</p></li>

        </ul>
    </objectives>
     <introduction>
        <p>A <term>first-order differential equation</term><idx><h>differential equation</h><h>first-order linear</h></idx> is an equation of the form
            <men xml:id="firstlook05-equation-first-order-linear-ode">\frac{dx}{dt} + p(t) x = q(t).</men>
       This equation will not be separable provided both <m>p(t)</m> and <m>q(t)</m> are both nonzero. We shall have to find a new approach to solving such an equation. We could, of course, use a numerical algorithm to solve<nbsp /><xref ref="firstlook05-equation-first-order-linear-ode" />; however, we can always find an algebraic solution to a first-order linear differential equation. Moreover, the fact that we can obtain such a solution analytically will prove very useful when we investigate more complicated equations and systems of equations.</p>
    </introduction>
    
    <subsection xml:id="firstlook05-subsection-mine-tailings">
        <title>Mine Tailings</title>

        <p>In any mining operation, tailings are what is left after everything of value has been extracted. For example, in a hard rock mining operation, ore is often pulverized and then processed using chemicals to extract certain minerals of value. Soft rock mining operations such as coal mining or extracting oil from tar sands might use solvents or water to extract any commodity of value. The material that is left over after the minerals, coal, or oil is extracted can often present huge environmental challenges. There are different ways of processing mine tailings, but one way is to store them in a pond, especially if water is used in the mining operation. This method allows any particles that are suspended in the water to settle to the bottom of the pond. The water can then be treated and recycled.</p>

        <p>Suppose that we have a gold mining operation and we are storing our tailings in a pond that has an initial volume of 20,000 cubic meters.  When we begin our operation, the tailings pond is filled with clean water. The pond has a stream flowing into it, and water is also pumped out of the pond.  Chemicals are used in processing gold ore. These chemicals such as sodium cyanide can be highly poisonous and dangerous to the environment, and the water must be treated before it is released into the watershed. Suppose that 1000 cubic meters per day flow into the pond from stream and 1000 cubic meters are pumped from the pond each day to be processed and recycled. Thus, the water level of the pond remains constant.</p>

        <p>At time <m>t = 0</m>, the water from stream becomes contaminated with chemicals from the mining operation, say at a rate of 5 kilograms of chemicals per 1000 cubic meters. We will assume that water in our tailings pond is well mixed so that the concentration of chemicals through out the pond is fairly uniform. In addition, any particulate matter pumped into the pond from the stream settles to the bottom of the pond at a rate of 50 cubic meters per day. Thus, the volume of our tailings pond is reduced by 50 cubic meters each day, and our tailings pond will become full after 400 days of operation. We shall assume that the particulate matter and the chemicals are included in the 1000 cubic meters that flow into the pond from the stream each day.</p>
        
        <p>We wish to find a differential equation that will model the amount of chemicals in the tailings pond at any particular time. Let <m>x(t)</m> be the amount of chemicals in the pond at time <m>t</m>. Then <m>dx/dt</m> is the difference between the rate at which the chemicals are entering the pond and the rate at which the chemicals leave the pond.
            <me>\frac{dx}{dt} = \text{rate in} - \text{rate out}.</me>
        Since water flows into the pond from the stream at a rate of 1000 cubic meters per day, the rate at which the chemicals enter the pond is 5 kilograms per day. On the other hand, the rate at which the chemicals leave the pond will depend on the amount of chemicals in the pond at time <m>t</m>. The volume of the pond is decreasing due to sediment, and at time <m>t</m> it is <m>V(t) = 20000 - 50t</m>. Thus, the concentration of chemicals in the pond at time <m>t</m> is <m>x/(20000 - 50 t)</m>, and the rate at which the chemicals are flowing out of the pond to be recycled is
            <me>1000 \left(  \frac{x}{20000 - 50t} \right) = \frac{20x}{ 400 - t}.</me>
        Hence, the differential equation that models the amount of chemical in the tailings pond at time <m>t</m> is
            <men xml:id="firstlook05-equation-mine-tailings-1">\frac{dx}{dt} = 5 - \frac{20x}{ 400 - t}.</men>
        Of course, we will have to cease mining operations once the pond is full, since there will only be water in the pond if <m>V(t) = 20000 - 50t \geq 0</m>; that is, when <m>0 \leq t \lt 400</m>.</p>

        <p>Notice that equation<nbsp /><xref ref="firstlook05-equation-mine-tailings-1" /> is not autonomous. In fact, it is not even separable. We will have to use a different approach to find a solution. First, we will rewrite the equation in the form
            <me>\frac{dx}{dt}  + \frac{20}{ 400 - t} x = 5.</me>
        If we multiply both sides of this equation by <m>(400 - t)^{-20}</m>, we obtain
            <men xml:id="firstlook05-equation-mine-tailings-2">(400 - t)^{-20}\frac{dx}{dt} + 20(400 - t)^{-21} x = 5(400 - t)^{-20}.</men>
        We now make the crucial observation that the product rule applies to the lefthand side of our equation,
            <me>(400 - t)^{-20}\frac{dx}{dt} + 20(400 - t)^{-21} x = \frac{d}{dt} \left( (400 - t)^{-20}x \right).</me>
        Thus, equation<nbsp /><xref ref="firstlook05-equation-mine-tailings-2" /> becomes
            <me>\frac{d}{dt} \left( (400 - t)^{-20}x \right) = 5(400 - t)^{-20}.</me>
        Integrating both sides of this equation, we have
            <me>(400 - t)^{-20}x = 5 \int (400 - t)^{-20} \, dt = \frac{5(400 - t)^{-19}}{19} + C,</me>
        where <m>C</m> is an arbitrary constant.  Solving for <m>x</m>, we obtain
            <me>x(t) = \frac{5}{19} (400 - t) + C(400 - t)^{20}.</me>
        Since <m>x(0) = 0</m>, we can quickly determine that <m>C = - (5/19)400^{-19}</m> and that the solution to our initial value problem is
            <me>x(t) = \frac{5}{19} (400 - t) \left[ 1 - \left( \frac{400 - t}{400}  \right)^{19} \right].</me>
        The graph of the solution to our differential equation (<xref ref="firstlook05-figure-tailings-pond" />) fits the situation. Initially, there are no chemicals in the pond, but <m>x(t)</m> quickly increases. However, the amount of chemicals decreases as the pond begins to fill with sediment. Eventually, there are no chemicals at <m>t = 400</m>.</p>

        <figure xml:id="firstlook05-figure-tailings-pond">
             <image width="60%">
                <xi:include href="prefigure/firstlook05-tailings-pond.xml"/>
              </image>
            <caption>Chemical waste in a tailings pond</caption>
        </figure>
        
    </subsection>

    <subsection xml:id="firstlook05-subsection-first-order-linear-de">
        <title>First-Order Linear Equations</title>

        <p>The differential equation
            <me>\frac{dx}{dt} + \frac{20}{ 400 - t} x = 5</me>
        is an example of a first-order linear differential equation. More specifically, a <term>first-order linear differential equation</term><idx><h>differential equation</h><h>first-order linear</h></idx> is an equation that can be written in the form
            <me>\frac{dx}{dt} + p(t) x = q(t).</me> 
        Let us first show how to solve first-order linear equations when the coefficient functions are constant. If 
            <md>
                <mrow>\frac{dx}{dt} + px &amp; = q,</mrow>
                <mrow>x(t_0) &amp; = x_0,</mrow>
            </md>
        then we first multiply both sides of the equation by <m>e^{pt}</m> to obtain
            <me>e^{pt} \frac{dx}{dt} + e^{pt} px = q e^{pt}.</me>
        The left-hand side of the equation is <term>exact</term><idx><h>differential equation</h><h>exact</h></idx>. That is,
            <me>e^{pt} \frac{dx}{dt} + e^{pt} px = \frac{d}{dt} \left(  x(t) e^{pt} \right).</me>
        If we integrate both sides of
            <me>\frac{d}{dt} \left(  x(t) e^{pt} \right)= q e^{pt},</me>
        then
            <me>x(t) e^{pt} = \frac{q}{p} e^{pt} + C.</me>
        If we apply the initial condition, we can determine <m>C</m>,
            <me>C = \left( x_0 - \frac{q}{p} \right) e^{pt_0}.</me>
        Thus, the solution that we seek is
            <me>x(t) = \frac{q}{p} + \left( x_0 - \frac{q}{p} \right) e^{p(t_0 - t)}.</me></p>

        <notation>
            <usage><m>\dfrac{dx}{dt} + p(t) x = q(t)</m></usage>
            <description>first-order linear differential equation</description>
        </notation>


        <example>
            <p>Suppose we wish to solve the initial value problem
                <mdn>
                    <mrow xml:id="firstlook05-equation-constant-coeff-1">\frac{dx}{dt} -2 x &amp; = 3,</mrow>
                    <mrow xml:id="firstlook05-equation-constant-coeff-2">x(0) &amp; = 1.</mrow>
                </mdn>
            Multiplying both sides of equation<nbsp /><xref ref="firstlook05-equation-constant-coeff-1" /> by <m>e^{-2t}</m>, we obtain
                <me>\frac{d}{dt}\left( e^{-2t}x \right) = e^{-2t}\frac{dx}{dt} -2 e^{-2t}x = 3e^{-2t}.</me>
            Integrating both sides of this last equation, gives us the following
                <me>e^{-2t}x = 3 \int e^{-2t} \, dt + C = -\frac{3}{2} e^{-2t} + C.</me>
            Applying the initial condition <m>x(0) = 1</m>, we can conclude that <m>C = 5/2</m>, and
                <me>x(t) = \frac{5}{2} e^{2t} - \frac{3}{2}.</me></p>
        </example>

        <example xml:id="firstlook05-example-nonconstant-coeff">
            <p>Now let us solve a first-order linear differential equation where the coefficients are not constant. Suppose that
                <me>y' + 2xy = e^{-x^2},</me>
            where <m>y(0) = 1</m>. We will multiply both sides of the equation by <m>e^{x^2}</m> and use the product rule to obtain
                <me>\frac{d}{dx} \left(  e^{x^2} y \right) = e^{x^2} y' + 2xe^{x^2}y =  e^{x^2} e^{-x^2} = 1.</me>
            Integrating both sides, we get
                <me>e^{x^2} y  = \int  dx +  C.</me>
            Thus, the general solution is 
                <me>y = (x + C) e^{-x^2}.</me>
            Using the initial condition to solve for <m>C</m>, we find that <m>C = 1</m> and
                <me>y = (x + 1)e^{-x^2}.  </me>
            We can use Sage to check our solution.</p>
        </example>

         <sage>
            <input>
            x = var('x')
            y = function('y')(x)
            de = diff(y, x) + 2*x*y == exp(-x^2)
            solution = desolve(de, y, ics = [0, 1])
            solution.show()
            </input>
            <output>
            (x + 1)*e^(-x^2)
            </output>
         </sage>


        <p>Surprisingly, the strategy in <xref ref="firstlook05-example-nonconstant-coeff" /> will always work. Suppose that
            <men xml:id="firstlook05-equation-first-order">x' + p(t) x = q(t).</men>
        If we choose <m>P(t)</m> such that <m>P'(t) = p(t)</m> and multiply both sides of the equation by <m>e^{P(t)}</m>, then
            <me>\left( e^{P(t)} x \right)' = e^{P(t)} ( x'(t) + p(t) x(t) )= e^{P(t)} q(t).</me>
        Integrating both sides,
            <me>e^{P(t)} x = \int e^{P(t)} q(t) \, dt + C</me>
        or
            <me>x = \frac{1}{e^{P(t)} } \left( \int e^{P(t)} q(t) \, dt + C \right).</me>
        The Fundamental Theorem of Calculus tells us that <m>P(t) = \int p(t) \, dt</m>. We say that
            <me>\mu(t) = e^{\int p(t) \, dt} = \exp\left(  \int p(t) \, dt \right)</me>
        is an <term>integrating factor</term><idx>integrating factor</idx> for the differential equation<nbsp /><xref ref="firstlook05-equation-first-order" />.</p>

        <example>
            <p>Consider the initial value problem
                <md>
                    <mrow>\frac{dy}{dx} - \frac{2}{x} y = 2x^2</mrow>
                    <mrow>y(-2) = 4.</mrow>
                </md>
            Our integrating factor is
                <me>\mu(x) = \exp\left( - \int \frac{2}{x} \, dx\right) = e^{-2 \ln x} = e^{\ln x^{-2}} = x^{-2}.</me>
            Multiplying both of our differential equation by <m>\mu(x) = x^{-2}</m>, we obtain
                <me>x^{-2} \left(\frac{dy}{dx} - \frac{2}{x} y \right)  = 2</me>
            or
                <me>\frac{d}{dx}\left(  x^{-2} y \right) = x^{-2} \frac{dy}{dx} - 2 x^{-3} y  = 2.</me>
            We can now integrate this equation to get
                <me>x^{-2} y = 2x + C.</me>
            The initial condition <m>y(-2) = 4</m> allows us to find <m>C = 5</m>. Therefore, the solution to our initial value problem is
                <me>y = 2x^3 + 5x^2.</me></p>
        </example>

        <activity>
            <title>Finding Solutions to First-Order Linear Differential Equations</title>

            <introduction>
                <p>Solve each of the following initial value problems.</p>
            </introduction>
            <task>
                <statement>
                    <p><m>y' = 3y + t</m>; <m>y(0) = 1</m></p>
                </statement>
            </task>
            <task>
                <statement>
                    <p><m>x' = tx + 2t</m>; <m>x(1) = 2</m></p>
                </statement>
            </task>
            <task>
                <statement>
                    <p><m>y' = 2x - 3y + e^{-x}</m>; <m>y(0) = 1</m></p>
                </statement>
            </task>
            <task>
                <statement>
                    <p><m>\dfrac{du}{dt} = \dfrac{t - 1}{t} u + t^2</m>; <m>u(1) = 0</m></p>
                </statement>
            </task>
            <task>
                <statement>
                    <p><m>y' = \sin x - y</m>; <m>y(0) = 1</m></p>
                </statement>
            </task>
        </activity>


    </subsection>
    
    <subsection xml:id="firstlook05-subsection-mixing-models">
        <title>Mixing Models</title>
        
        <p>Many applications involve the mixing of two or more substances together. As we mentioned previously, we can model how petroleum products are mixed together in a refinery, how various ingredients are mixed together in a brewery, or how greenhouse gases move across various layers of the earth's atmosphere.</p>
        
        <example>
            <p>Suppose that a 100-gallon tank initially contains 50 gallons of salt water containing five pounds of salt. A brine mixture containing one pound of salt per gallon flows into the top of the tank at a rate of 5 gallons per minute. A well mixed solution leaves the tank at rate of 4 gallons per minute. We wish to know how much salt is in the tank, when the tank is full.</p>

            <p>To construct our model, we will let <m>t</m> be the time (measured in minutes) and set up a differential equation that will measure how fast the amount of salt at time <m>t</m>, <m>x(t)</m>, is changing. We have the initial condition <m>x(0) = 5</m>, and 
                <md>
                    <mrow>\frac{dx}{dt} &amp; = \text{rate of salt flowing in} - \text{rate of salt flowing out}</mrow>
                    <mrow>&amp; = \underbrace{5}_{\text{in flow}} - \underbrace{4 \frac{x}{V(t)}}_{\text{out flow}},</mrow>
                </md>
            where <m>V(t)</m> is the volume at time <m>t</m>. The expression <m>x/V(t)</m> is the amount of salt in one gallon at time <m>t</m>. We have <m>V(t) = 50 + t</m>, since the tank starts with 50 gallons and five gallons are pumped into the tank per minute while four gallons leave the tank during the same time interval. Thus, our differential equation becomes
                <me>\frac{dx}{dt} = 5 - \frac{4}{50 + t}x.</me>
            Our equation is linear since we can rewrite it as
                <men xml:id="firstlook05-equation-mixing">\frac{dx}{dt} + \frac{4}{50 + t} x = 5.</men></p>

            <p>An integrating factor for this differential equation is 
                <me>\mu(t) = \exp\left(  \int \frac{4}{50 + t} \, dt \right) = e^{4 \ln(50 + t)} = (50 + t)^4.</me>
            Therefore, if we multiply both sides of equation<nbsp /><xref ref="firstlook05-equation-mixing" /> by <m>\mu(t)</m>, we get
                <me>(50 + t)^4\frac{dx}{dt} + 4(t + 50)^3 x = 5(50 + t)^4.</me>
            We can now apply the product rule to obtain
                <me>\frac{d}{dt}[ (50 + t)^4 x] = 5(50 + t)^4.</me>
            Integrating both sides and simplifying gives us
                <me>x = t + 50 + \frac{C}{(t + 50)^4}.</me>
            Our initial condition, <m>x(0) = 5</m> tells us that <m>C = -281{,}250{,}000</m> and
                <me>x(t) = t + 50 - \frac{281250000}{(t + 50)^4}.</me>
            Thus, when the tank is full, <m>t = 50</m> and the amount of salt in the tank is <m>x(50) = 97.188</m> pounds. We can use <em>Sage</em> to easily check the solution of our initial value problem.</p>
        </example>

        <sage>
            <input>
            t = var('t')
            x = function('x')(t)
            de = diff(x, t) + 4*x/(50 + t) == 5
            solution(t) = desolve(de, x, ics=[0, 5])
            solution(50).n(digits = 5)
            </input>
            <output>
            97.188
            </output>
        </sage>

        <activity>
            <title>A Mixing Problem</title>

            <introduction>
                <p>Suppose that a tank contains 1000 gallons of a solution consisting of 200 pounds of salt dissolved in water. Pure water is pumped into the tank at a rate of 6 gallons per minute. At the same time, the tank is drained at the same rate.  Assume that the brine mixture is kept well stirred.</p>
            </introduction>
            <task>
                <statement>
                    <p>Set up an initial value problem to model the amount of salt in the tank at time <m>t</m>.</p>
                </statement>
            </task>
            <task>
                <statement>
                    <p>How long will it take until there is only 20 pounds of salt left in the tank?.</p>
                </statement>
            </task>
        </activity>

    </subsection>
    
    <subsection xml:id="firstlook05-subsection-finance-models">
        <title>Finance Models</title>

        <p>There are a number of problems in finance that can be modeled using differential equations. Let <m>P(t)</m> be the balance of an account at time <m>t</m> and suppose that the account pays interest at a rate of <m>r</m> percent per year compounded continuously. Suppose that we also allow withdrawals of <m>W</m> dollars per year. The net increase in the balance between times <m>t</m> and <m>t + \Delta t</m> can now be described as
            <me>P(t + \Delta t) - P(t) \approx r P \Delta t - W \Delta t</me>
        Thus,
            <me>P'(t) = \lim_{\Delta t \rightarrow 0} \frac{P(t + \Delta t) - P(t) }{\Delta t} = rP - W.</me></p>

        <p>We can solve the equation
            <me>P' = rP - W</me>
        by multiplying both sides of the equation by the integrating factor
            <me>\mu(t) = \exp\left(- \int r \, dt\right) = e^{-rt}.</me>
        to obtain
            <me>\frac{d}{dt} [e^{-rt} P] = -We^{-rt}.</me>
        Integrating both sides of this equation, we have
            <me>e^{-rt} P = \frac{W}{r} e^{-rt} + C</me>
        or
            <me>P = \frac{W}{r} + Ce^{rt}.</me>
        If we know the initial balance in the account, say <m>P(0) = P_0</m>, we can determine <m>C</m>. That is,
            <me>P_0 = \frac{W}{r} + C</me>
        or 
            <me>C = P_0 - \frac{W}{r}.</me>
        Thus, the solution to our initial value problem is
            <me>P = \frac{W}{r} + \left( P_0 - \frac{W}{r} \right) e^{rt}.</me></p>

        <example>
            <p>Suppose that your parents have established a money market account with a balance of $50,000 that they will use to help you pay for your college education.  The account receives an average annual interest of 4%. You estimate that your tuition, room and board, and other college expenses to be $20,000 per year.</p>

            <p>We model this financial situation with the differential equation
                <md>
                    <mrow>\frac{dP}{dt} \amp = 0.04P - 20000</mrow>
                    <mrow>P(0) \amp = 50000.</mrow>
                </md>
            Rewriting the differential equation as <m>dP/dt - 0.04P = -20000</m>, our integrating factor becomes <m>\mu(t) = e^{-0.04t}</m>, and
                <me>e^{-0.04t} \frac{dP}{dt} -0.04 e^{-0.04t} P= \frac{d}{dt} [e^{-0.04t} P] = -20000e^{-0.04t}.</me>
            Thus, 
                <me>e^{-0.04t} P = \frac{20000}{0.04}e^{-0.04t} + C = 500000e^{-0.04t} + C.</me>
            The solution to this initial value problem is
                <me>P(t) = \frac{20000}{0.04} + \left( 50000 - \frac{20000}{0.04} \right) e^{0.04t} = 500000 - 450000e^{0.04t}.</me></p>

            <p>Your parents have been quite generous but have told you that you must be responsible for the balance of the cost of your education.</p>


        </example>

        <activity>
            <title>Paying for College</title>

            <introduction>
                <p>Suppose that new parents want to start a college fund for their child.  They are willing to invest $2000 per year at a rate of 4%.</p>
            </introduction>
            <task>
                <statement>
                    <p>Find an initial value problem that models the parents' investment.</p>
                </statement>
            </task>
            <task>
                <statement>
                    <p>How much will be in the college fund when their child turns 18?</p>
                </statement>
            </task>
            <task>
                <statement>
                    <p>What would they need to invest per year to have $80,000 in the college fund when their child turns 18?</p>
                </statement>
            </task>
        </activity>
    </subsection>
    
    <subsection>
        <title>Existence and Uniqueness of Solutions</title>

        <p>Several questions about the existence and uniqueness of solutions to first-order linear differential equations now arise.
            <ul>

            <li><p>Does an initial value problem always have a solution?</p></li>

            <li><p>Is the solution unique?</p></li>

            <li><p>Is the solution globally defined or does it only hold for a small interval?</p></li>

            </ul>
        We can use the following theorem to answer these questions.</p>

        <theorem xml:id="theorem-firstlook05-first-order-linear-existence">
            <statement>
                <p>If 
                    <me>y' + p(t) y = g(t)</me>
                is a differential equation such that <m>y(t_0) = y_0</m>, and <m>p(t)</m> and <m>g(t)</m> are continuous on the open interval <m>I = (\alpha, \beta)</m>, then there exists a unique function <m>y = \phi(t)</m> satisfying the differential equation and the initial condition on <m>I</m>.</p>
            </statement>
            <proof>
                <p>If 
                    <me>\mu(t) = \exp\left(  \int p(t) \, dt \right),</me>
                then
                    <me>\frac{d}{dt}(\mu(t) y) = \mu(t) \left( \frac{dy}{dt} + p(t) y \right) = \mu(t)g(t).</me>
                Integrating both sides of this equation and solving for <m>y</m>, we have
                    <men xml:id="firstlook05-equation-solution">y = \frac{1}{\mu(t)} \left( \int \mu(t) g(t) \, dt + C \right).</men>
                Since <m>y(t_0) = y_0</m>, the constant <m>C</m> is uniquely determined.  Notice that we have used continuity to guarantee that the integrals exist.  We leave it as an exercise to show that  <xref ref="firstlook05-equation-solution" /> is a solution to <m>y' + p(t) y = g(t)</m>.</p>
            </proof>
        </theorem> 

    </subsection>

    <subsection xml:id="firstlook05-subsection-important-lessons">
        <title>Important Lessons</title>
        
        <p><ul>
        
            <li><p>Any first-order linear differential equation
                <me>y' + p(x) y = g(x)</me>
            can be solved by multiplying each side of the equation by an integrating factor
                <me>\mu(s) = e^{\int p(x) \, dx}.</me>
            In this case, we get
                <me>\left( e^{P(x)} y \right)' = e^{P(x)} ( y'(x) + p(x) y(x) ) = e^{P(x)} g(x).</me>
            Integrating  both sides,
                <me>e^{P(x)} y  = \int e^{P(x)} g(x) \, dx</me>
            or
                <me>y = \frac{1}{e^{P(x)} } \int e^{P(x)} g(x) \, dx.</me></p></li>

            <li><p>If 
                <me>y' + p(t) y = g(t)</me>
            is a differential equation such that <m>y(t_0) = y_0</m>, and <m>p(t)</m> and <m>g(t)</m> are continuous on the open interval <m>I = (\alpha, \beta)</m>, then there exists a unique function <m>y = \phi(t)</m> satisfying the differential equation and the initial condition on <m>I</m>.</p></li>

        </ul></p>
                
    </subsection>

    <reading-questions xml:id="reading-questions-firstlook05">

        <exercise xml:id="reading-questions-firstlook05-1" label="rq-firstlook05-first-order">
            <statement>
                <p>Explain in your own words what a first-order linear differential equation is.</p>
            </statement>
            <response/>
        </exercise>

        <exercise xml:id="reading-questions-firstlook05-2" label="rq-firstlook05-product-rule">
            <statement>
                <p>What important rule from differential calculus do we use when solving a first-order differential equation?</p>
            </statement>
            <response/>
        </exercise>

    </reading-questions>


    <exercises xml:id="exercises-firstlook05"  filenamebase="firstlook05">
    <title>Exercises</title>


     <exercisegroup cols="2" xml:id="firstlook05-exercises-find-solutions">
            <title>Finding General Solutions</title>
            <introduction><p>Find the general solution for each equation in <xref ref="firstlook05-exercises-find-solutions"/>.</p></introduction>
            <exercise>
                <statement>
                    <p><m>\dfrac{dy}{dx} + 5y = 0</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>x' - 7x = 0</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>y' + 2xy = 0</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>\dfrac{dx}{dt} -t^2 x  = 0</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>y' + \dfrac{2}{x}y = 0</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>\dfrac{dy}{dx} - 5y = e^x</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>y' - 5y = 10x</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>\dfrac{dx}{dt} - 5x = \sin 2t</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>y' - \dfrac{3}{x^2} y = \dfrac{1}{x^2}</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>\dfrac{dy}{dx} + \dfrac{2}{x} y = \dfrac{\sin x}{x^2}</m></p>
                </statement>
            </exercise>
        </exercisegroup>

        <exercisegroup cols="2" xml:id="firstlook05-exercises-solve-ivps">
            <title>Solving Initial Value Problems</title>
            <introduction><p>Solve the initial value problems in <xref ref="firstlook05-exercises-solve-ivps"/>.</p></introduction>
             <exercise>
                <statement>
                    <p><m>\dfrac{dy}{dx} + 5y = 0</m>, <m>y(0) = 2</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>x' - 7x = 0</m>, <m>x(0) = 1</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>y' + 2xy = 0</m>, <m>y(0) = 3</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>\dfrac{dx}{dt} -t^2 x  = 0</m>, <m>x(0) = -1</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>y' + \dfrac{2}{x}y = 0</m>, <m>y(1) = -3</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>y' = - \dfrac{2y}{x + 1} + 2x</m>, <m>y(0) = 2</m></p>
                </statement>
                <hint>
                    <p><m>y = \dfrac{3 x^{4} + 8 x^{3} + 6 x^{2} + 12}{6 (x + 1)^2}</m></p>
                </hint>
            </exercise>
            <exercise>
                <statement>
                    <p><m>y' = - \dfrac{2y}{1 + x} + e^x</m>, <m>y(0) = 1</m></p>
                </statement>
                <hint>
                    <p><m>y = (e^x + 1)/(x+1)^2</m></p>
                </hint>
            </exercise>
            <exercise>
                <statement>
                    <p><m>\dfrac{dx}{dt} - 5x = \sin 2t</m>, <m>x(0) = \pi</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>y' = y \tan x + \dfrac{e^x}{\cos x}</m>, <m>y(0) = 1</m></p>
                </statement>
                <hint>
                    <p><m>y = e^x \sec x</m></p>
                </hint>
            </exercise>
            <exercise>
                <statement>
                    <p><m>y' = - \dfrac{y}{x + 2} + \dfrac{\cos x}{x + 2}</m>, <m>y(0) = 1</m></p>
                </statement>
                <hint>
                    <p><m>y = \sin x / (x + 2)</m></p>
                </hint>
            </exercise>
        </exercisegroup>

        <exercise>
            <statement>
                <p>A 600-liter tank initially contains 200 liters of water containing 10 kilograms of salt. Supposed that water containing 0.1 kilograms of salt per liter flows into the top of the tank at a rate of 10 liters per minute. The water in the tank is kept well mixed, and 5 liters per minute are removed from the bottom of the tank.  How much salt is in the tank when the tank is full?</p>
            </statement>
            <hint>
                <p>If <m>x(t)</m> is the amount of salt in the tank at time <m>t</m>, we know that <m>x(0) = 10</m>. The volume of the tank is <m>V = 200 + 5t</m>.  We can model the amount of salt in the tank at time <m>t</m> with a differential equation,
                    <md>
                        <mrow>\frac{dx}{dt} &amp; = \text{rate in} - \text{rate out}</mrow>
                        <mrow>&amp; = 10(0.1) - 5 \frac{x}{V}</mrow>
                        <mrow>&amp; = 1 - 5\frac{x}{200+ 5t}</mrow>
                        <mrow>&amp; = 1 - \frac{x}{40 + t}.</mrow>
                    </md>
                The resulting equation
                    <me>\frac{dx}{dt} + \frac{1}{40 + t}x = 1</me>
                is a first order linear differential equation.  An integrating factor for this equation is given by
                    <me>\mu(t) = \exp\left(\int \frac{1}{40 + t} \, dt\right) = 40 + t.</me>
                Multiplying both sides of the differential equation by <m>\mu(t)</m>, we have
                    <me>\frac{d}{dt} [(40 + t)x] = (40 + t) \frac{dx}{dt} + x = (40 + t)\left( \frac{dx}{dt} + \frac{1}{40 + t}x \right) = 40 + t.</me>
                Integrating both sides of this equation, we obtain
                    <me>(40 + t)x = 40t + \frac{t^2}{2} + C.</me>
                Using the intial condition <m>x(0) = 10</m>, we can determine that <m>C = 400</m> or
                    <me>x(t) = \frac{t^2 + 80t + 800}{2t + 80}.</me>
                The tank is full at time <m>t = 400/5 = 80</m>, and the tank contains <m>x(80) = 170/3 \approx 56.67</m> kilograms of salt when the tank is full.</p>
            </hint>
        </exercise>

        <exercise>
            <statement>
                <p>A manager in a communications company contributes $2400 per year into her retirement fund by making many small deposits throughout the year.  The fund grows at a rate of 3.5% per year compounded continuously.  After 35 years, she retires and begins and begins withdrawing from the retirement fund at a rate of $3500 per month.  If she does not make any deposits after she retires, how long will her retirement fund last?  [<em>Hint</em>: Divide the problem into two smaller problems<mdash />one that deals with the situation before retirement and one that deals with the problem after retirement.]</p>
            </statement>

        </exercise>

        <exercise>
            <statement>
                <p>Lake Baikal, located in southern Siberia, is only the seventh largest lake in the world in terms of surface area; however, it is the world's deepest lake. The lake has a depth of 1,642 meters, and the bottom lies 1,186.5 meters below sea level. Lake Baikal has a volume of 23,600 cubic kilometers and contains 20% of the world's unfrozen fresh water. In contrast, Lake Superior, the largest of the Great Lakes, has a volume of only 12,100 cubic kilometers.  Although 544 rivers flow into Lake Baikal, there is only a single outlet, the Angara River. The outflow of the lake is pretty constant at 60.4 cubic kilometers per year.</p>
            
                <p>Pollution is an increasing concern in Lake Baikal. One of the major polluters has been Baykalsk Pulp and Paper Mill. The mill was constructed in 1966 on the shoreline of Lake Baikal and regularly discharged waste into the lake. The plant was closed in November 2008 due to unprofitability, but production resumed in January 2010. The mill underwent a final bankruptcy in September 2013, but the longterm fate of the mill is still undecided.<fn>Levy, Clifford J. (November 8, 2010). <q>Last Gasp for Factory Bequeathed by Soviets.</q> The New York Times. Retrieved March 14, 2014 from <url href="http://www.nytimes.com/2010/11/09/world/europe/09baikal.html" visual="www.nytimes.com/2010/11/09/world/europe/09baikal.html" />.</fn></p>

                <p>Suppose that we wish to understand how the pollution level changes in Lake Baikal over a period of years. Hypothetically, let us assume that the Baykalsk Pulp and Paper Mill has been responsible for most of the pollution in Lake Baikal for the last several decades. Suppose that at <m>t = 0</m> years the mill ceases operation and there are no longer any pollutants discharged into the lake from the mill although there are still other sources of pollution. Let us assume that the lake is currently 6 times more polluted than these other sources of contaminants. We wish to know how long it will take for the pollution level to reduce to half of its current level of lake.  Lake Baikal's waters are well-mixed and well-oxygenated in spite of its great depth, so we can model this situation as a simple mixing problem.
                    <ol>
           
                        <li><p>The volume of water in Lake Baikal is <m>V = 23,600 \text{ km}^3</m>, and
                            <me>r_{\text{in}} = r_{\text{out}} = r = 60 \text{ km}^3/\text{year}</me>
                        be the rates of inflow from the numerous rivers that feed the lake and outflow to the Angara River. Assume that <m>C = C_{\text{in}}</m> is the pollutant concentration flowing into Lake Baikal and <m>C_{\text{out}}</m> is the concentration of the outflow into the Angara River (measured in metric tons per cubic km). If <m>x(t)</m> is the amount of solute at time <m>t</m> in Lake Baikal, then
                            <me>x_0 = x(0) = 6CV</me>
                        is the initial amount of solute in the lake.  Estimate <m>\Delta x</m> during the time interval <m>[t, t + \Delta t]</m>, where <m>\Delta t > 0</m> is small.</p></li>

                        <li><p>From your estimate of <m>\Delta x</m> in part (1), write an initial value problem that describes the amount of pollutants in the lake at time <m>t</m>.</p></li>
                
                        <li><p>The equation that you found in part (2) is a first-order linear equation. Solve this equation.</p></li>

                        <li><p>Using part (3), predict how many years it will take to reduce the pollution in Lake Baikal to half of its current level.</p></li>
                        
                    </ol></p>
            </statement>
        </exercise> 

        <exercise>
            <statement>
                <p>Show that
                    <me>y = \frac{1}{\mu(t)} \left( \int \mu(t) g(t) \, dt + C \right)</me>
                is a solution to <m>y' + p(t) y = g(t)</m>.</p>
            </statement>
        </exercise>

        <exercise>
            <title>Exact Differential Equations</title>
            <statement>
                <p>A first-order differential equation, <m>M(x,y) \, dx + N(x,y) \, dy = 0</m>, is <em>exact</em> if there exists a function <m>g(x,y)</m> such that
                    <me>dg(x, y) = M(x,y) \, dx + N(x,y) \, dy.</me>
                    <ol>

                        <li><p>If <m>M(x, y)</m> and <m>N(x,y)</m> and have continuous first-order partial derivatives on some rectangle in the <m>xy</m>-plane, then prove that 
                            <me>M(x,y) \, dx + N(x,y) \, dy = 0</me>
                        is exact if and only if 
                            <me>\frac{\partial M(x,y)}{\partial y} = \frac{\partial N(x,y)}{\partial x}.</me></p></li>

                        <li><p>Show that the differential equation <m>2xy \, dx + (1 + x^2) \, dy = 0</m> is exact.</p></li>

                        <li><p>Solve the differential equation <m>2xy \, dx + (1 + x^2) \, dy = 0</m>.</p></li>

                        <li><p>In general, the differential equation <m>M(x,y) \, dx + N(x,y) \, dy = 0</m> is not exact.  However, we can sometimes transform this equation into an exact equation by multiplying the equation by an integrating factor
                            <me>\mu(x,y)[M(x,y) \, dx + N(x,y) \, dy] = 0.</me>
                            <ol>

                                <li><p>Show that <m>-1/x^2</m> is integrating factor for <m>y \, dx - x \, dy</m>.</p></li>

                                <li><p>Show that <m>1/y^2</m> is integrating factor for <m>y \, dx - x \, dy</m>.</p></li>

                                <li><p>Show that <m>-1/(xy)</m> is integrating factor for <m>y \, dx - x \, dy</m>.</p></li>

                                <li><p>Show that <m>-1/(x^2 + y^2)</m> is integrating factor for <m>y \, dx - x \, dy</m>.</p></li>

                            </ol></p></li>

                        <li><p>Solve the differential equation <m>(y^2 - xy^2) \, dx + (x + x^2y^2) \, dy</m>.</p></li>

                    </ol></p>
            </statement>
            <hint>
                <p>For (e), rewrite the equation as 
                    <me>(y \, dx + x \, dy) + (-xy^2 \, dx + x^2 y^2 \, dy) = 0</me>
                and consider the integrating factor <m>\mu(x, y) = 1/(xy)^2</m>.</p>
            </hint>
        </exercise>

        <exercise>
            <title>Variation of Parameters</title>
            <statement>
                <p>Consider the following method of solving the general linear equation of the first order,
                    <men xml:id="firstlook05-exercise-equation-variation-of-parameters-1">y' + p(t)y = g(t).</men>
                    <ol>

                        <li><p>If <m>g(t)</m> is identically zero, show that the solution is
                            <me>y = A \exp\left[ - \int p(t) \, dt \right],</me>
                        where <m>A</m> is a constant.</p></li>

                        <li><p>If <m>g(t)</m> is not identically zero, assume that the solution is of the form
                            <men xml:id="firstlook05-exercise-equation-variation-of-parameters-2">y = A(t) \exp\left[ - \int p(t) \, dt \right],</men> 
                        where <m>A</m> is now a function of <m>t</m>.  By substituting for <m>y</m> in the given differential equation <xref ref="firstlook05-exercise-equation-variation-of-parameters-1" />, show that <m>A(t)</m> must satisfy the condition
                            <men xml:id="firstlook05-exercise-equation-variation-of-parameters-3">A'(t) = g(t) \exp\left[ \int p(t) \, dt \right].</men></p></li>

                        <li><p>Find <m>A(t)</m> from Equation <xref ref="firstlook05-exercise-equation-variation-of-parameters-3" />.  Then substitute for <m>A(t)</m> in equation <xref ref="firstlook05-exercise-equation-variation-of-parameters-2" /> and determine <m>y</m>.  Verify that the solution obtain in this manner agrees with the solution given in the proof of Theorem <xref ref="theorem-firstlook05-first-order-linear-existence" />.  That is, show that this solution is equivalent to the solution
                            <me>y = \frac{1}{\mu(t)} \left( \int \mu(t) g(t) \, dt + C \right),</me>
                        where
                            <me>\mu(t) = \exp\left(  \int p(t) \, dt \right).</me></p></li>

                    </ol>This technique is know as <em>variation of parameters</em>, which we will revisit when we study second order linear differential equations.</p>
            </statement>
        </exercise>

        <exercise>
            <title>Bernoulli's Equation</title>
            <statement>
            <p><em>Bernoulli's equation</em> is an equation of the form
                <me>y' = a(t) y + f(t) y^n,</me>
            where <m>n \neq 0</m> or 1. Bernoulli's equation is nonlinear and cannot be solved by the techniques that we have used to solve first order linear equations.<fn>Polking p. 63</fn>
                <ol>

                    <li><p>Using the substitution <m>z = y^{1- n}</m>, show that we can transform Bernoulli's equation into the linear equation
                        <me>z' = (1 -n )a(t) z + (1-n) f(t).</me></p></li>

                    <li><p>Solve the equation <m>xy' + y = x^4y^3</m>.</p></li>

                </ol></p>
            </statement>


        </exercise> 


        <exercise>
            <statement>
                <p>The first-order nonlinear differential equation
                    <men xml:id="firstlook05-exercise-equation-ricatti">y' = p(t) + q(t) y + r(t) y^2</men>
                is known as the <term>Ricatti equation</term><idx>Ricatti equation</idx> and has some useful applications in control theory. If one solution <m>y_1(t)</m> of the Ricatti equation is known, then a more general solution containing an arbitrary constant can be found by substituting <m>y = y_1(t) + 1/v(t)</m> into equation <xref ref="firstlook05-exercise-equation-ricatti" /> to find a first-order linear equation in <m>v</m> and <m>t</m>, which we can solve to find a general solution to the Ricatti equation.  
                    <ol>

                        <li><p>Show that this first-order linear equation is <m>v' + [q(t) + 2 r(t) y_1(t)]v = - r(t)</m>.</p></li>

                        <li><p>Find the solution to the Ricatti equation
                            <me>y' = - \frac{1}{t^2} - \frac{1}{t} y + y^2</me>
                        given the particular solution <m>y_1 = 1/t</m>.</p></li>

                        <li><p>Find the solution to the Ricatti equation
                            <me>y' = \cos t - y \tan t + y^2 \sec t</me>
                        given the particular solution <m>y_1 = \sin t</m>.</p></li>

                        <li><p>Find the solution to the Ricatti equation
                            <me>y' = 2 - 3y + y^2</me>
                        given the particular solution <m>y_1 \equiv 2</m>.</p></li>

                    </ol></p>
            </statement>
            <hint>
                <p><ol>
                    
                        <li><p>If <m>y = y_1 + 1/v</m>, then <m>y' = y_1' - v'/v^2</m>.  Substituting into our original equation, we obtain
                            <me>y' = y_1' - \frac{v'}{v^2} = p + q y_1 + r y_1^2 - \frac{v'}{v^2}.</me>
                        On the other hand,
                            <md>
                                <mrow>y' &amp; = p + q \left(y_1 + \frac{1}{v}  \right) + r  \left(y_1 + \frac{1}{v}  \right)^2</mrow>
                                <mrow> &amp; = p + q y_1 + \frac{q}{v}  + r  y_1^2 + \frac{2r y_1}{v}   + \frac{r}{v^2}</mrow>
                                <mrow> &amp; = y_1' +  \frac{q}{v}  + \frac{2r y_1}{v} + \frac{r}{v^2}.</mrow>
                            </md>
                        Therefore,
                            <me>- \frac{v'}{v^2} =  \frac{q}{v}  + \frac{2r y_1}{v}   + \frac{r}{v^2},</me>
                        which is just the first-order linear equation
                            <me>v' + [q(t) + 2 r(t) y_1(t)]v = - r(t).</me></p></li>

                        <li><p><me>y = t + \frac{1}{C - t}</me></p></li>

                        <li><p><me>y(t) = \frac{1}{C \cos t - \sin t} + \sin t</me></p></li>

                        <li><p><me>y(t) = 2 + \frac{1}{C e^t - 1}</me></p></li>
                    
                    </ol></p>
            </hint>

        </exercise> 
        
        <exercise>
            <statement>
                <p>Suppose that we have a population that not only grows logistically but also requires a minimum threshold population to survive.  For example, the case of the North Pacific right whale, a species now very much on the endangered list.  If the population drops too low, whales might not be able to find suitable mates and the species will eventually go extinct.  In other words, the population will die out if it drops below a certain threshold.  We can model this with the following equation,
                    <men xml:id="firstlook05-exercise-equation-right-whale">\frac{dP}{dt} = k\left(1 - \frac{P}{N} \right) (P - aN),</men>
                where <m>P</m> is the population of the whales at time <m>t</m> and <m>N</m> is the carrying capacity.  The constants <m>k</m> and <m>a</m> are positive with <m>a \lt 1</m>.
                    <ol>
                    
                        <li><p>Find the equilibrium solutions of this equation.</p></li>
                        
                        <li><p>Since equation <xref ref="firstlook05-exercise-equation-right-whale" /> is autonomous, we can find a solution using separation of variables.  Find this solution.</p></li>
                        
                        <li><p>Equation <xref ref="firstlook05-exercise-equation-right-whale" /> is also a Ricatti equation  <xref ref="firstlook05-exercise-equation-ricatti" />.  Since we know an equilibrium solution from part (1), we can use the method of the previous problem to find a general solution to <xref ref="firstlook05-exercise-equation-right-whale" />.  Find the general solution using the fact that we have a Ricatti equation and show that your solution agrees with the solution that you found in part (2).</p></li>
                        
                 
                    </ol></p>
            </statement>
    
        </exercise>
            
        <exercise>
            <statement>
                <p>The differential equation
                    <me>\frac{dy}{dt} = y - 4t + y^2 - 8yt + 16 t^2 + 4.</me>
                is not autonomous, separable, or linear; however, we can solve this equation with a change of variable.
                    <ol>

                        <li><p>Transform this equation into a new differential equation of the form 
                            <me>\frac{du}{dt}= f(u)</me>
                        by letting <m>u = y - 4t</m>.</p></li>

                        <li><p>Sketch the phase line for this new equation, <m>u' = f(u)</m>, and sketch several solutions.</p></li>

                        <li><p>Find the solutions of the original differential equation that correspond to the equilibrium solutions of <m>u' = f(u)</m>. Graph these solutions in <m>ty</m>-plane.  Also, sketch the graphs of the solutions that you plotted in part (b).</p></li>
                        
                        <li><p>Solve the differential new equation and use this information to solve the original differential equation.</p></li>
                
                    </ol></p>
            </statement>
        </exercise>

 
    </exercises>


 </section>


<!--</section>-->
