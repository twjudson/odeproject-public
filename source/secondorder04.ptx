<?xml version="1.0" encoding="UTF-8"?>

<!-- This file is part of the book                                 -->
<!--                                                               -->
<!--    Ordinary Differential Equations Project                    -->
<!--                                                               -->
<!-- Copyright (C) 2013-2025 Thomas W. Judson                      -->
<!-- See the file COPYING for copying conditions.                  -->

<section xml:id="secondorder04" xmlns:xi="http://www.w3.org/2001/XInclude">
    <title>Forcing and Resonance</title>
    <objectives>
        <ul>

            <li><p>To understand how the natural frequency, <m>\omega_0</m>, interacts with the frequency of the forcing term, <m>\omega</m> in an undamped harmonic oscillator
                <me>x'' + \omega_0^2 x = A \cos \omega t.</me>
            If the two frequencies are the same, we can observe a phenomenon called <term>resonance</term>. If the two frequencies are close, we can observe a phenomenon called <term>beats</term>.</p></li>


            <li><p>To understand that the <term>gain</term> (or frequency response) <m>G(\omega)</m> of a 
            forced damped harmonic oscillator,
                <me>x'' + 2c x' + \omega_0^2 x = A \cos \omega t</me>
            is defined as the absolute value of the ratio of the output amplitude to the steady-state input amplitude and that the amplitude and phase of the steady-state solution is given by
                <me>x_p(t) = G(\omega) A \cos(\omega t - \phi).</me></p></li>

        </ul>
    </objectives>    
    <introduction>

        <p>Resonance happens when the natural frequency and the forcing frequency of an undamped harmonic oscillator are the same. There are many real world examples of resonance. For example, it is possible for a trained singer to shatter a champagne glass by simply singing the correct note (see <url href="https://www.youtube.com/watch?v=IZD8ffPwXRo" visual="www.youtube.com/watch?v=IZD8ffPwXRo" />). Shattering a glass by singing the correct note can be modeled by an equation of an undamped harmonic oscillator with sinusoidal forcing. While a certain amount of damping occurs in all physical systems, the damping is often so small that it makes sense to use an undamped harmonic oscillator.</p>

    </introduction>

    <subsection xml:id="secondorder04-subsection-resonance">
        <title>Resonance</title>

        <p>Resonance was responsible for the collapse of the Broughton suspension bridge near Manchester, England in 1831. The collapse occurred when a column of soldiers marched in cadence over the bridge, setting up a periodic force of rather large amplitude. The frequency of the force was approximately equal to the natural frequency of the bridge. Thus, the bridge collapsed when large oscillations occurred. For this reason soldiers are ordered to break cadence whenever they cross a bridge.</p>
        
        <p>The Millennium Bridge, the first new bridge to span the Thames River in London in over 100 years, is a modern example of how resonance can effect a bridge (<xref ref="secondorder04-figure-millennium-bridge" />). This pedestrian bridge, which opened to the public in June 2000, was quickly closed after the bridge experienced high amplitude horizontal oscillations during periods of high traffic. Studies by designers found that the bridge experienced high amplitude horizontal oscillations in response to horizontal forcing at a rate of one cycle per second. Typically, people walk at a rate of two steps per second, so the time between two successive steps of the left foot is about one second. Thus, if people were to walk in cadence, they could set up strong horizontal forcing that would place a destructive load on the bridge. The engineers did not envision this to be a problem since tourists do not generally march in time. However, a video of tourists crossing the bridge revealed the opposite.  When the bridge began oscillating, people tended to walk in cadence in order to keep their balance (<url href="https://www.youtube.com/watch?v=gQK21572oSU" visual="www.youtube.com/watch?v=gQK21572oSU" />).</p>

        <figure xml:id="secondorder04-figure-millennium-bridge">
            <caption>The Millennium Bridge</caption>
            <image width="60%" source="millennium-bridge.jpg">
                <description>a photo of the Millennium Bridge in London</description>
            </image>
        </figure>

        <p>Consider the case of an undamped harmonic oscillator with a sinusoidal forcing function. We know that we can model this situation with the second-order linear differential equation
            <me>x'' + \omega_0^2 x = A \cos \omega t.</me>
        Since the homogeneous solution to this equation is 
            <me>x_h(t) = c_1 \cos \omega_0 t + c_2 \sin \omega_0 t,</me>
        we can see that the <term>natural frequency</term><idx>natural frequency</idx> of the harmonic oscillator is <m>\omega_0</m>. This is the frequency of the oscillations if there is no forcing term. Depending on whether or not the frequency of the forcing term <m>\omega</m> is equal to the natural frequency, we will have two very different situations. If the two frequencies are equal, then they will re-enforce one another and we will have <term>resonance</term><idx>resonance</idx>. If the two frequencies are close but not equal, we will see the phenomenon of <term>beats</term><idx>beats</idx>. We wish to investigate what happens when the <term>driving frequency</term><idx>driving frequency</idx> <m>\omega</m> is equal to the natural frequency and when it is not.</p>

        <notation>
            <usage><m>\omega_0</m></usage>
            <description>natural frequency</description>
        </notation>

        <notation>
            <usage><m>\omega</m></usage>
            <description>driving frequency</description>
        </notation>

        <p>Let us examine the case where the forcing frequency and the natural frequency of the oscillator are the same,
            <men xml:id="secondorder04-equation-resonance-5">x'' + \omega_0^2 x = A \cos \omega_0 t.</men>
        Since <m>A \cos \omega_0 t</m> is a solution to the homogeneous equation <m>x'' + \omega_0^2 x = 0</m>, we cannot assume that a particular solution to equation <xref ref="secondorder04-equation-resonance-5" /> has the form <m>a \cos \omega_0 t + b \sin \omega_0 t</m>. Equivalently, if we use the complex method, we cannot assume that our solution has the form <m>ae^{i \omega_0t}</m>. Therefore, we will look for a complex solution of the form
            <me>x_c = a t e^{i \omega_0 t}</me>
        for the complex equation that corresponds to <xref ref="secondorder04-equation-resonance-5" />,
            <men xml:id="secondorder04-equation-resonance-6">x'' + \omega_0^2 x = A e^{i \omega_0 t}.</men>
        In this case,
            <md>
                <mrow>x_c' &amp;  = a ( 1 + i \omega_0 t )e^{i \omega_0 t} </mrow>
                <mrow>x_c'' &amp;  = a (2 i \omega_0 - \omega_0^2 t) e^{i \omega_0 t}.</mrow>
            </md>
        Substituting <m>x_c</m> and <m>x_c''</m> into the left-hand side of <xref ref="secondorder04-equation-resonance-6" />, we have
            <md>
                <mrow>x_c'' + \omega_0^2 x_c &amp;  = a (2 i \omega_0 - \omega_0^2 t )e^{i \omega_0 t} + \omega_0^2 a t e^{i \omega_0 t}</mrow>
                <mrow>&amp; = 2ai \omega_0 e^{i \omega t}.</mrow>
            </md>
        In order for <m>x_c = a t e^{i \omega_0 t}</m> to be a solution to <xref ref="secondorder04-equation-resonance-6" />, we must have
            <me>a = \frac{A}{2 i \omega_0}.</me>
        Thus, our solution to the complex form of the differential equation is
            <md>
                <mrow>x_c &amp;  = \frac{A}{2i \omega_0} t e^{i \omega_0 t}</mrow>
                <mrow>&amp; = - \frac{Ai}{2 \omega_0} t e^{i \omega_0 t}</mrow>
                <mrow>&amp; = - \frac{Ai}{2 \omega_0} t (\cos \omega_0 t + i \sin \omega_0 t)</mrow>
                <mrow>&amp; = \frac{A}{2 \omega_0} t \sin \omega_0 t - i \frac{A}{2 \omega_0} t \cos \omega_0 t.</mrow>
            </md>
         The real part of <m>x_c</m>,
                <me>x_p(t) = \frac{A}{2 \omega_0} t \sin \omega_0 t,</me>
         is a particular solution to <xref ref="secondorder04-equation-resonance-5" />. Thus, our general solution is
            <me>x(t) = x_h(t) + x_p(t) = c_1 \cos \omega_0 t + c_2 \sin \omega_0 t + \frac{A}{2 \omega_0} t \sin \omega_0 t.</me></p>

        <example>

            <p>Now let us consider the initial value problem
                <md>
                    <mrow>x'' + 144 x &amp; = 4 \cos 12t</mrow>
                    <mrow>x(0) &amp; = 0</mrow>
                    <mrow>x'(0) &amp; = 0.</mrow>
                </md>
            where <m>A = 4</m> and <m>\omega_0 = 12</m>. The solution to the homogeneous equation <m>x'' + 144 x = 0</m> is
                <me>x_h(t) = c_1 \cos 12t + c_2 \sin 12t.</me>
            To find a particular solution to <m>x'' + 144 x = 4 \cos 12t</m>, we will use the complex method and try to find a particular solution to <m>x'' + 144 x = 4 e^{12it}</m>. We must assume that the solution has the form <m>x_c(t) = a t e^{12it}</m>, since <m>a e^{12it}</m> is a solution to the homogeneous equation. As before, we have <m>x_c'' = a (24i - 144 t) e^{12it}</m>. If we substitute <m>x_c</m> and <m>x_c''</m> into the left-hand side of our differential equation, we have
                <me>x_c'' + 144 x_c = a (24i - 144 t) e^{12it} + 144 a t e^{12i t} = 24ai e^{12i t}.</me>
            Therefore,
                <me>a = \frac{4}{24i} = - \frac{1}{6}i,</me>
            and our complex solution is
                <me>- \frac{1}{6} i  t e^{12it} = - \frac{1}{6} i t (\cos 12t + i \sin 12 t) = \frac{1}{6} t \sin 12 t - \frac{1}{6} i t \cos 12 t.</me>
            Taking the real part of our complex solution, we have a particular solution
                <me>x_p(t) = \frac{1}{6} t \sin 12t.</me>
            Thus, the general solution to <m>x'' + 144 x = 4 \cos 12t</m> is
                <me>x(t) = x_h(t)  + x_p(t)= c_1 \cos 12t + c_2 \sin 12t + \frac{1}{6} t \sin 12t.</me>
            Applying the initial conditions, both <m>c_1 = 0</m> and <m>c_2 = 0</m>. Consequently, the solution to the initial value problem is 
                <me>x(t) = \frac{1}{6} t \sin 12t.</me>
            The graph of this solution is given in <xref ref="secondorder04-figure-resonance-3" />. Notice that our solution grows with time. This growth is due to the fact that the frequency of the forcing term is equal to the natural frequency of the oscillator. Since the force pulls and pushes at a frequency equal to the natural frequency of the oscillator, the amplitude increases with time. This type of behavior is called <term>resonance</term>.</p>

            <figure xml:id="secondorder04-figure-resonance-3">
                 <image width="50%">
                        <xi:include href="prefigure/secondorder04-resonance-3.xml"/>
                  </image>
                <caption>The solution to <m>x'' + 4 x = 4 \sin 2t</m>, <m>x(0) = 0</m>, <m>x'(0) = 0</m>.</caption>
            </figure>                 

        </example>

        <activity>
            <title>Resonance</title>

            <introduction>
                <p>Solve each of the following initial value problems and plot the solution for <m>t \geq 0</m>.  In each case, what is the natural (and forcing) frequency of the harmonic oscillator?</p>
            </introduction>
            <task>
                <statement>
                    <p><md>
                        <mrow>x'' + 121 x &amp; = 3 \cos 11t</mrow>
                        <mrow>x(0) &amp; = 0</mrow>
                        <mrow>x'(0) &amp; = 0.</mrow>
                    </md></p>
                </statement>
            </task>   
            <task>
                <statement>
                    <p><md>
                        <mrow>x'' + 169 x &amp; = 5 \cos 13t</mrow>
                        <mrow>x(0) &amp; = 0</mrow>
                        <mrow>x'(0) &amp; = 0.</mrow>
                    </md></p>
                </statement>
            </task>   

        </activity>

    </subsection>

    <subsection xml:id="secondorder04-subsection-beats">
        <title>Beats or the Case <m>\omega \neq \omega_0</m></title>

        <p>If the forcing frequency and natural frequency are not equal but close, then we have the phenomenon of beats. For example, a piano tuner uses this phenomenon to make certain that a particular string is correctly tuned. The tuner will strike a tuning fork which vibrates at the correct frequency. Next, the tuner hits the poorly tuned piano string. This modulation gives rise to beats in the tone that are readily audible. When the string is properly tuned, the beats will go away. To see another example of beats, watch the video <url href="https://www.youtube.com/watch?v=pRpN9uLiouI" visual="www.youtube.com/watch?v=pRpN9uLiouI" />.</p>

        <p>To understand the situation where the forcing and natural frequencies differ by a small amount, <m>\omega \neq \omega_0</m>, we will first consider the equation,
            <men xml:id="secondorder04-equation-beats-1">x'' + \omega_0^2 x = A \cos \omega t.</men>
        The solution to the homogeneous equation <m>x'' + \omega_0^2 x = 0</m> is
            <me>x_h(t) = c_1 \cos \omega_0 t + c_2 \sin \omega_0 t.</me>
        Since the forcing frequency is not equal to the natural frequency, we can look for a particular solution to the complex of the form of equation <xref ref="secondorder04-equation-beats-1" />, 
            <men xml:id="secondorder04-equation-beats-2">x'' + \omega_0^2 = A e^{i \omega t}.</men>
        If we assume that our solution has the form <m>x_c = a e^{i\omega t}</m> and substitute <m>x_c</m> into the left-hand side of <xref ref="secondorder04-equation-beats-2" />, we find
            <md>
                <mrow>x_c'' + \omega_0^2 x_c \amp = -a \omega^2 e^{i \omega t} + \omega_0^2 a e^{i \omega t}</mrow>
                <mrow>\amp = a(\omega_0^2 - \omega^2)e^{i \omega t}.</mrow>
            </md>
        Therefore, for <m>x_c = a e^{i\omega t}</m> to be a solution for
            <me>x'' + \omega_0^2 x = Ae^{i\omega t},</me>
        we must have
            <me>a = \frac{A}{\omega_0^2 - \omega^2}.</me>
        The real part of <m>x_c</m> is a particular solution to <xref ref="secondorder04-equation-beats-1" />,
            <me>x_p(t) = \frac{A}{\omega_0^2 - \omega^2} \cos \omega t.</me>
        Thus, the general solution to <xref ref="secondorder04-equation-beats-1" /> is
            <me>x(t) = x_h(t) + x_p(t) = c_1 \cos \omega_0 t + c_2 \sin \omega_0 t + \frac{A}{\omega_0^2 - \omega^2} \cos \omega t.</me></p>

        <p>Now let us examine the case where the motion starts at equilibrium. That is, we will investigate what happens when <m>x(0) = 0</m> and <m>x'(0) = 0</m>. In this case, we can easily determine that <m>c_1 = -A/(\omega_0^2 - \omega^2)</m> and <m>c_2 = 0</m>.  Hence the solution to our initial value problem is
            <men xml:id="secondorder04-equation-resonance-2">x(t) = \frac{A}{\omega_0^2 - \omega^2} (\cos \omega t - \cos \omega_0 t).</men>
        Thus, we have a superposition to two oscillations of different frequencies.</p>

        <p>To understand how the superposition of the two frequencies works, we will let
            <me>\overline{\omega} = \frac{\omega_0 + \omega}{2}</me>
        be the <term>mean frequency</term><idx>mean frequency</idx> and
            <me>\delta = \frac{\omega_0 -  \omega}{2}</me>
        be the <term>half difference</term><idx>half difference</idx>. Since <m>\omega = \overline{\omega} - \delta</m> and <m>\omega_0 = \overline{\omega} + \delta</m>, we know that
            <md>
                <mrow>x(t) &amp; = \frac{A}{\omega_0^2 - \omega^2} (\cos \omega t - \cos \omega_0 t)</mrow>
                <mrow>&amp; = \frac{A}{(\overline{\omega} + \delta)^2 - (\overline{\omega} - \delta)^2} (\cos [(\overline{\omega} - \delta) t] - \cos[(\overline{\omega} + \delta) t])</mrow>
                <mrow>&amp; = \frac{A}{4\overline{\omega} \delta} [\cos(\overline{\omega} t - \delta t) - \cos(\overline{\omega}t + \delta t)]</mrow>
                <mrow>&amp; = \frac{A}{4\overline{\omega} \delta} [\cos(\overline{\omega} t) \cos( \delta t)  + \sin(\overline{\omega} t) \sin( \delta t) - \cos(\overline{\omega} t) \cos( \delta t) + \sin(\overline{\omega} t) \sin( \delta t)]</mrow>
                <mrow>&amp; = \frac{A}{4\overline{\omega} \delta} [2 \sin(\overline{\omega} t) \sin( \delta t)]</mrow>
                <mrow>&amp; = \frac{A \sin \delta t}{2 \overline{\omega} \delta} \sin \overline{\omega} t.</mrow>
            </md>
        Thus, we have a sine function, <m>\sin \overline{\omega} t</m> whose amplitude varies according to <m>|(A/2 \overline{\omega} \delta) \sin \delta t|</m>, and 
            <men xml:id="secondorder04-equation-resonance-3">x(t) = \frac{A \sin \delta t}{2 \overline{\omega} \delta} \sin \overline{\omega} t.</men></p>

        <notation>
            <usage><m>\overline{\omega}</m></usage>
            <description>mean frequency</description>
        </notation>

        <notation>
            <usage><m>\delta</m></usage>
            <description>half difference</description>
        </notation>
        
        <example>
            <p>In the initial value problem
                <mdn>
                    <mrow xml:id="secondorder04-equation-resonance-7">x'' + 144 x \amp = 4 \cos(13t)</mrow>
                    <mrow>x(0) \amp = 0</mrow>
                    <mrow>x'(0) \amp = 0,</mrow>
                </mdn>
                we have <m>A= 4</m>, <m>\omega_0 = 12</m>, and <m>\omega = 13</m>. The solution to this equation is
                <me>x(t) = \frac{4}{25}(\cos 12 t - \cos 13 t).</me>
            The graph of this solution is given in <xref ref="secondorder04-figure-resonance-4" /> and illustrate the phenomenon of <term>beats</term>. The two frequencies are almost equal and interfere with each other.</p>

            <figure xml:id="secondorder04-figure-resonance-4">
                 <image width="50%">
                     <xi:include href="prefigure/secondorder04-resonance-4.xml"/>
                  </image>
                <caption>The solution to <m>x'' + 144 x = 4 \cos 13t</m>, <m>x(0) = 0</m>, <m>x'(0) = 0</m>.</caption>
            </figure>    

            <p>In our example, <m>\delta = -1/2</m> and <m>\overline{\omega} = 25/2</m>. The factor  <m>\sin \delta t = \sin( - t/2)</m> in <xref ref="secondorder04-equation-resonance-3" /> oscillates very slowly in comparison to <m>\sin(\overline{\omega}) = \sin(25t/2)</m>. Thus, we can view the solution <xref ref="secondorder04-equation-resonance-3" /> as a fast oscillation with a frequency <m>\overline{\omega}</m> and amplitude
                <men xml:id="secondorder04-equation-resonance-4">\left| \frac{A \sin \delta t}{2 \overline{\omega} \delta} \right| = \left| \frac{8}{25} \sin\left( \frac{t}{2}\right)\right|,</men>
            which oscillates much more slowly. If we superimpose the graph of <xref ref="secondorder04-equation-resonance-4" /> onto the graph in <xref ref="secondorder04-figure-resonance-4" />, we obtain an <term>envelope</term><idx>envelope</idx> of the faster oscillation.</p>

            <figure xml:id="secondorder04-figure-resonance-5">
                 <image width="50%">
                        <xi:include href="prefigure/secondorder04-resonance-5.xml"/>
                  </image>
                <caption>Envelope for the initial value problem<nbsp /><xref ref="secondorder04-equation-resonance-7" /></caption>
            </figure> 

        </example>
 
        <activity>
            <title>Beats</title>

            <introduction>
                <p>Consider the initial value problem
                    <md>
                        <mrow>x'' + 196 x \amp = 4 \cos(15t)</mrow>
                        <mrow>x(0) \amp = 0</mrow>
                        <mrow>x'(0) \amp = 0.</mrow>
                    </md></p>
            </introduction>
            <task>
                <statement>
                    <p>Solve the initial value problem and plot its solution.</p>
                </statement>
            </task>   
            <task>
                <statement>
                    <p>Calculate the mean frequency, <m>\overline{\omega} = (\omega_0 + \omega)/2</m>, and the half difference, <m>\delta = (\omega_0 - \omega)/2</m>, where <m>\omega_ 0</m> is the natural frequency and <m>\omega</m> is the forcing frequency and rewrite the solution to the initial value problem in the form <xref ref="secondorder04-equation-resonance-3" />.</p>
                </statement>
            </task>   
            <task>
                <statement>
                    <p>Plot the envelope, <m>|(A \sin \delta t)/(2 \overline{\omega} \delta)|</m>, over the plot of the solution to the initial value problem.</p>
                </statement>
            </task> 
            <task>
                <statement>
                    <p>Discuss what is going on in this activity.</p>
                </statement>
            </task>   
        </activity>

    </subsection>

    <subsection xml:id="secondorder04-subsection-forced-damped">
        <title>Forced Damped Harmonic Motion</title>

        <p>Since perpetual motion does not really exist, we should consider what happens when we add some damping to our harmonic oscillator,
            <men xml:id="secondorder04-equation-force-damped-1">x'' + 2c x' + \omega_0^2 x = A \cos \omega t.</men></p>

        <example xml:id="example-secondorder04-force-damped">
            <p>Let us consider the differential equation
                <men xml:id="secondorder04-equation-example-0">x'' + 2x' + 2x = 3 \cos 4t.</men>
            The corresponding homogeneous equation is
                <me>x'' + 2x' + 2x = 0,</me>
            which has solution
                <me>x_h(t) = c_1 e^{-t} \cos t + c_2 e^{-t} \sin t.</me>
            To find a particular solution for the equation <xref ref="secondorder04-equation-example-0" />, we will look for a solution of the form <m>x_c = a e^{4 i t}</m> to the equation
                <men xml:id="secondorder04-equation-example-3">x'' + 2x' + 2x = 3e^{4 it}</men>
            and then set <m>x_p(t)</m> to the real part of the solution. Substituting <m>x_c</m> into the lefthand side of <xref ref="secondorder04-equation-example-3" />, we obtain
                <me>x_c'' + 2x_c' + 2 x_c = (-14 + 8i) a e^{4it} = P(4i)a e^{4it} = 3e^{4 it},</me>
            where <m>P(\lambda) = \lambda^2 + 2 \lambda + 2</m> is the characteristic polynomial of <m>x'' + 2x' + 2x = 0</m>.
            Therefore, 
                <me>a = \frac{3}{P(4i)} = \frac{3}{-14 + 8i} = - \frac{3}{130}(7 + 4i),</me>
            and the solution to the complex equation is
                <md>
                    <mrow>x_c \amp = - \frac{3}{130}(7 + 4i)e^{4 i t}</mrow>
                    <mrow>\amp = - \frac{3}{130}(7 + 4i)(\cos 4t + i \sin 4t)</mrow>
                    <mrow>\amp = \frac{3}{130}[(- 7 \cos 4t + 4 \sin 4t) + i(- 4 \cos 4t - 7 \sin 4t)].</mrow>
                </md>
            Thus, we can determine a particular solution by taking the real part of <m>x_c</m>,
                <me>x_p(t) = \frac{3}{130}(- 7 \cos 4t + 4 \sin 4t).</me>
            The general solution for <xref ref="secondorder04-equation-example-0" /> is
                <me>x(t) = x_h(t) + x_p(t) = c_1 e^{-t} \cos t + c_2 e^{-t} \sin t +  \frac{3}{130}(- 7 \cos 4t + 4 \sin 4t).</me>
            It is easy to see that all solutions approach <m>x_p(t)</m> as <m>t \to \infty</m> no matter what the initial conditions may be. However, it would be much more useful if we would write the particular solution in the form
                <me>x_p(t) = K \cos(4 t - \phi )</me>
            for some constants <m>K</m> and <m>\phi</m> rather than a linear combination of <m>\cos 4t</m> and <m>\sin 4t</m>.</p>
        </example>

        <p>Returning to the general case, the associated homogeneous equation for <xref ref="secondorder04-equation-force-damped-1" /> is 
            <men xml:id="secondorder04-equation-force-damped-2">x'' + 2c x' + \omega_0^2 x = 0.</men>
        The characteristic polynomial of <xref ref="secondorder04-equation-force-damped-2" />,
            <men xml:id="secondorder04-equation-force-damped-3">P(\lambda ) = \lambda^2 + 2c \lambda + \omega_0^2,</men>
        has roots
            <me>\lambda = - c \pm \sqrt{c^2 - \omega_0^2}.</me>
        If our harmonic oscillator is undedamped (<m>c \lt \omega_0</m>), then the solution to the homogeneous equation<nbsp /><xref ref="secondorder04-equation-force-damped-2" /> is
            <me>x_h = e^{-ct} (c_1 \cos \beta t + c_2 \sin \beta t),</me>
        where <m>\beta = \sqrt{\omega_0^2 - c^2}</m>.</p>

        <p>As in <xref ref="example-secondorder04-force-damped" />, we will look for a particular solution to <xref ref="secondorder04-equation-force-damped-1" /> by examining the equivalent complex differential equation. That is, we shall look for a solution of the form <m>x_c = a e^{i \omega t}</m> to the equation
            <men xml:id="secondorder04-equation-force-damped-4">x_c'' + 2c x_c' + \omega_0^2 x_c = Ae^{i \omega t},</men>
        and then set <m>x_p</m> equal to the real part of our solution. Substituting <m>x_c</m> into the right-hand side of <xref ref="secondorder04-equation-force-damped-4" />, we obtain
            <me>x_c'' + 2c x_c' + \omega_0^2 x_c = [(i\omega)^2 + 2c(i \omega) + \omega_0^2] a e^{i \omega t} = P(i \omega) a e^{i \omega t},</me>
        where <m>P</m> is the characteristic polynomial<nbsp /><xref ref="secondorder04-equation-force-damped-3" />. Thus, equation<nbsp /><xref ref="secondorder04-equation-force-damped-4" /> becomes
            <me>P(i \omega) a e^{i \omega t} =  Ae^{i \omega t},</me>
        and
            <me>x_c(t) = a e ^{i \omega t} = \frac{A}{P(i \omega)} e^{i \omega t} =  H(i \omega) A e^{i \omega t},</me>
        where
            <me>H(i \omega) = \frac{1}{P(i \omega)}.</me>
        We say that <m>H(\lambda) = 1 / P(\lambda)</m> is the <term>transfer function</term><idx>transfer function</idx>.</p>

        <p>Let us examine the transfer function more closely to see if we can use it to write our particular solution in a more useable form. First, let us write 
            <me>P(i \omega ) = (i\omega)^2 + 2c(i \omega) + \omega_0^2 = (\omega_0^2 - \omega^2) + 2ic \omega.</me>
        in polar form,
            <me>P(i \omega) = R e^{i \phi} = R(\cos \phi + i \sin \phi),</me>
        where
            <me>R = \sqrt{(\omega_0^2 - \omega^2)^2 + 4 c^2 \omega^2}</me>
        and <m>\phi</m> is the angle defined by the equations
            <md>
                <mrow>\cos \phi &amp; = \frac{\omega_0^2 - \omega^2}{\sqrt{(\omega_0^2 - \omega^2)^2 - 4 c^2  \omega^2}},</mrow>
                <mrow>\sin \phi &amp; = \frac{2c\omega}{\sqrt{(\omega_0^2 - \omega^2)^2 - 4 c^2  \omega^2}}.</mrow>
            </md>
        Since <m>2 c \omega \gt 0</m>, we know that <m>\sin \phi \gt 0</m>.  Equivalently, <m>0 \lt \phi \lt \pi</m>.  Thus,
            <me>\phi = \phi(\omega) = \cot^{-1} \left( \frac{\omega_0^2 - \omega^2}{2c \omega} \right).</me>
        Therefore, we can write the transfer function as
            <me>H(i \omega) = \frac{1}{P(i \omega)} = \frac{1}{R} e^{-i \phi}.</me>
        We define the <term>gain</term><idx>gain</idx> to be 
            <me>G(\omega) = \frac{1}{R} = \frac{1}{\sqrt{(\omega_0^2 - \omega^2)^2 + 4 c^2 \omega^2}},</me>
        and we will rewrite the transfer function as
            <me>H(i \omega) = G(\omega) e^{-i \phi(\omega)}.</me>
        Thus, the solution to
            <me>x_c'' + 2c x_c' + \omega_0^2 x_c = Ae^{i \omega t}</me>
        is
            <men xml:id="secondorder04-equation-force-damped-complex">x_c(t) = H(i \omega) A e^{i \omega t} = G(\omega) A e^{i(\omega t - \phi)}.</men>
        Taking the real part of <xref ref="secondorder04-equation-force-damped-complex" />, our particular solution is
            <me>x_p(t) =  \real(x_c(t)) = G(\omega) A \cos(\omega t - \phi ).</me></p>

        <p>It is now clear that particular solution has the same frequency as the forcing term. In addition, <m>x_p</m> is out of phase with the driving force by the amount
            <me>\phi = \phi(\omega) = \cot^{-1} \left( \frac{\omega_0^2 - \omega^2}{2c \omega}\right).</me>
        The general solution to
            <me>x'' + 2c x' + \omega_0^2 x = A \cos \omega t</me>
        is
            <me>x(t) = x_h(t) + x_p(t) = e^{-ct} (c_1 \cos(\eta t) + c_2 \sin(\eta t)) + G(\omega) A \cos(\omega t - \phi).</me>
        Since <m>x_h</m> has the factor <m>e^{-ct}</m>, the homogeneous part of the solution quickly decays to zero as <m>t \to \infty</m>. For this reason, <m>x_h</m> is called the <term>transient term</term><idx>transient term</idx> while <m>x_p</m> is called the <term>steady-state term</term><idx>steady-state term</idx>.</p>

        <notation>
            <usage><m>H(\lambda)</m></usage>
            <description>transfer function</description>
        </notation>

        <notation>
            <usage><m>G(\omega)</m></usage>
            <description>gain</description>
        </notation>

        <example>
            <p>Let us examine the steady-state solution of the harmonic oscillator in <xref ref="example-secondorder04-force-damped" />. We have already determined that the second-order linear differential equation
                <me>x'' + 2x' + 2x = 3 \cos 4t</me>
            has solution
                <me>x(t) = x_h(t) + x_p(t) = c_1 e^{-t} \cos t + c_2 e^{-t} \sin t + \frac{3}{130}(- 7 \cos 4t + 4 \sin 4t).</me>
            The natural frequency is <m>\omega_0 = \sqrt{2} \approx 1.4142</m>
            If we choose the initial conditions so that <m>c_1 = 0</m> and <m>c_2 = 1</m>, our transient term is
                <me>x_h(t) = e^{-ct} \sin \beta t = e^{-t} \sin t.</me>
            Since <m>c = 1</m>, <m>\omega = 4</m>, and <m>A = 3</m>, the gain is <m>G(4) \approx 0.0620</m>, the amplitude of the steady state solution is <m>G(4) \cdot 4 \approx 0.2481</m>. The phase is <m>\phi = \phi(4) \approx 2.6224.</m> The solution and the steady-state solution are given in <xref ref="secondorder04-figure-forced-spring-steady-state" />. As we can see, transient solutions can be quite large when compared to steady-state solutions.</p>

            <figure xml:id="secondorder04-figure-forced-spring-steady-state">
                 <image width="50%">
                        <xi:include href="prefigure/secondorder04-forced-spring-steady-state.xml"/>
                  </image>
                <caption>A forced damped harmonic oscillator and the steady-state solution.</caption>
            </figure> 

        </example>



         <p>Large transient currents can be destructive in electrical circuits. For example, a light bulb usually burns out when a large transient flows through an already weakened bulb. This, usually occurs at the time the light bulb is turned on or turned off. Large transient currents are particularly harmful to the hard drive in a computer. For this reason, computers should be left on except in the case that they are not being used for a period of several days.</p>


    </subsection>

    <subsection xml:id="secondorder04-subsection-important-lessons">
        <title>Important Lessons</title>
            
        <p><ul>
        
            <li>A forced damped harmonic oscillator,
                <me>x'' + 2c x' + \omega_0^2 x = A \cos \omega t</me>
            has homogeneous solution
                <me>x_h = e^{-ct} (c_1 \cos \eta t + c_2 \sin \eta t),</me>
            where <m>\eta = \sqrt{\omega_0^2 - c^2}</m>. A particular solution is given by
                <me>x_p(t) = \real(x_c(t)) = G(\omega) A \cos(\omega t - \phi ),</me>
            where the phase angle <m>\phi</m> is
                <me>\phi = \phi(\omega) = \cot^{-1} \left( \frac{\omega_0^2 - \omega^2}{2c \omega} \right)</me>
            and the gain <m>G</m> is given by
                <me>G(\omega) = \frac{1}{\sqrt{(\omega_0^2 - \omega^2)^2 + 4 c^2 \omega^2}}.</me></li>

            <li>The amplitude and phase of the steady-state solution,
                <me>x_p(t) = G(\omega) A \cos(\omega t - \phi),</me>
            are determined by
                <me>\omega_0^2G = \frac{1}{\sqrt{(1- s^2)^2 + D^2 s^2}},</me>
            where <m>\omega = s \omega_0</m> and <m>D = 2c/\omega_0</m>.</li>
        
            <li>In an undamped harmonic oscillators with a sinusoidal forcing term, the natural frequency of the solution interacts with the frequency of the forcing term. As the frequency of the forcing term approaches the natural frequency of the equation, we can observe a phenomenon called <term>resonance</term>. We can use the equation
                <me>x'' + \omega_0^2 x = A \cos \omega t</me>
            to model an undamped harmonic oscillator with sinusoidal forcing.</li>

            <li>If the driving frequency is not equal to the natural frequency (<m>\omega \neq \omega_0</m>), we have a particular solution
                <me>x_p(t) = \frac{A}{\omega_0^2 - \omega^2} (\cos \omega t - \cos \omega_0 t).</me>
            If the two frequencies are close, we can see a phenomenon called <term>beats</term>.</li>

            <li>If the driving frequency is equal to the natural frequency, we have a particular solution
                <me>x_p(t)  = \frac{A}{2 \omega_0} t \sin \omega_0 t.</me>
            In this case, we can see the <term>resonance</term> phenomenon.</li>

            <li>A forced damped harmonic oscillator,
                <me>x'' + 2c x' + \omega_0^2 x = A \cos \omega t</me>
            has homogeneous solution
                <me>x_h = e^{-ct} (c_1 \cos \eta t + c_2 \sin \eta t),</me>
            where <m>\eta = \sqrt{\omega_0^2 - c^2}</m>. A particular solution is given by
                <me>x_p(t) = \real(x_c(t)) = G(\omega) A \cos(\omega t - \phi),</me>
            where the phase angle <m>\phi</m> is
                <me>\phi = \phi(\omega) = \cot^{-1} \left( \frac{\omega_0^2 - \omega^2}{2c \omega} \right)</me>
            and the gain <m>G</m> is given by
                <me>G(\omega) = \frac{1}{\sqrt{(\omega_0^2 - \omega^2)^2 + 4 c^2 \omega^2}}.</me></li>

        </ul></p>
    
    </subsection>


    <reading-questions xml:id="reading-questions-secondorder04">

        <exercise xml:id="reading-questions-secondorder04-1">
            <statement>
                <p>Describe what resonance means in your own words.</p>
            </statement>
            <response/>
        </exercise>

        <exercise xml:id="reading-questions-secondorder04-2">
            <statement>
                <p>Describe in words alone what the steady state solution of a damped harmonic oscillator is.</p>
            </statement>
            <response/>
        </exercise>

    </reading-questions>

    <exercises xml:id="secondorder04-exercises"  filenamebase="secondorder04">
        <title>Exercises</title>

        <exercisegroup xml:id="secondorder04-exercises-beats-resonance">
            <title>Beats and Resonance</title>
            <introduction><p>Solve the initial problems in <xref ref="secondorder04-exercises-beats-resonance"/>. Do you find any beats or resonance?</p></introduction>
            <exercise>
                <statement>
                    <p><m>y'' + y = \cos t</m>, <m>y(0) = 0</m>, <m>y'(0) = 0</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>y'' + y = \cos(11t/10)</m>, <m>y(0) = 0</m>, <m>y'(0) = 0</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>y'' + 4y = \sin 2 t</m>, <m>y(0) = 1</m>, <m>y'(0) = 0</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>y'' + 4y = 3 \sin(13t/12)</m>, <m>y(0) = 1</m>, <m>y'(0) = -1</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>y'' + 16y = 5\cos 4t</m>, <m>y(0) = 1</m>, <m>y'(0) = 0</m></p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>y'' + 16y = 5\cos(4t +1)</m>, <m>y(0) = 0</m>, <m>y'(0) = 0</m></p>
                </statement>
            </exercise>                    
        </exercisegroup>  

        <exercisegroup cols="2" xml:id="secondorder04-exercises-graph-beats">
            <title>Plotting the Envelope for Beats</title>
            <introduction><p>For each of the functions in <xref ref="secondorder04-exercises-graph-beats"/> compute the envelope function. Then plot <m>y(t)</m> and the envelope function on the same set of axes.</p></introduction>
            <exercise>
                <statement>
                    <p><m>y = \cos 10 t - \cos 11t</m>.</p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>y = \cos 11 t - \cos 12t</m>.</p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>y = \sin 11 t - \sin 10t</m>.</p>
                </statement>
            </exercise>
            <exercise>
                <statement>
                    <p><m>y = \sin 12 t - \sin 11t</m>.</p>
                </statement>
            </exercise>                   
        </exercisegroup>  

        <exercise>
            <statement>
                <p>Consider the function <m>y = \cos 10 t - \cos 11t</m>.
                    <ol>
                        <li>Find the mean frequency <m>\overline{\omega} = (\omega_0 + \omega)/2</m> and half difference <m>\delta = (\omega_0 -  \omega)/2</m>.</li>

                        <li>Use (a) to show that 
                            <me>y = \cos 10 t - \cos 11t = 2 \sin\left( \frac{1}{2} t \right) \sin(\left( \frac{21}{2} t \right).</me>
                        You will find the following trigonmetric identity very useful,
                            <me>2 \sin A \sin B = \cos(A - B) - \cos(A + B).</me></li>

                        <li>Using (b), plot the graph of <m>y</m> and <m>2 \sin(t/2)</m> on the same axes.</li>
                    </ol></p>
            </statement>
        </exercise>     

        <exercise>
            <statement>
                <p>For large <m>t</m>, every solution of 
                    <me>y'' + py' + qy = \cos \omega t</me>
                oscillates with angular frequency <m>\omega</m> and amplitude <m>A</m> given by
                    <me>A( \omega, p, q) = \frac{1}{\sqrt{(q - \omega^2)^2 + p^2 \omega^2}}.</me>
                That is, the amplitude of <m>A</m> is a function of the parameters <m>\omega</m>, <m>p</m>, and <m>q</m>.
                    <ol>

                        <li>Compute <m>\dfrac{\partial A}{\partial \omega}</m>.</li>
                        
                        <li>For fixed <m>p</m> and <m>q</m>, let <m>M(p, q)</m> denote the maximum value of <m>A( \omega, p, q)</m> as a function of <m>\omega</m>. Compute an expression for <m>M(p, q)</m>.</li>
                        
                        <li>Set <m>q = 1</m> and plot <m>M(p, q)</m> as a function of <m>p</m>.</li>
                        
                        <li>Explain why <m>M(p, q)</m> is proportional to <m>1/p</m> as <m>p \to 0</m>.</li>

                    </ol></p>
            </statement>

        </exercise>             

        <exercise>
            <statement>
                <p>Let us examine the amplitude and phase of the steady-state solution,
                    <me>x_p(t) = G(\omega) A \cos(\omega t - \phi),</me>
                where
                    <me>G(\omega) = \frac{1}{\sqrt{(\omega_0^2 - \omega^2)^2 + 4 c^2 \omega^2}}.</me>
                Now let <m>s = \omega / \omega_0</m> and <m>D = 2c/\omega_0</m>.  These new constants, <m>s</m> and <m>D</m>, measure the ratio of the driving frequency to the natural frequency and the effect of the damping force, respectively.  Thus,
                    <me>G = \frac{1}{\omega_0^2\sqrt{(1- s^2)^2 + D^2 s^2}}</me>
                or
                    <me>\omega_0^2G = \frac{1}{\sqrt{(1- s^2)^2 + D^2 s^2}}.</me>
                This expression shows us how the gain varies as <m>s = \omega/\omega_0</m> varies.  The natural frequency is fixed in
                    <me>x'' + 2c x' + \omega_0^2 x = A \cos \omega t</me>
                and <m>D = 2c/\omega_0</m> is proportional to the damping constant.</p>
            </statement>

        </exercise>             

    </exercises>


</section>

<!--</section>-->
